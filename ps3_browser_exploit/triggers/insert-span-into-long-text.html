<html>
<head>
<style>
#highlighted
{
white-space: pre-wrap;
}
</style>
  <script>
    function runTest() {
		/*
		 r0=0000000000000000        r8=000000000000001A       r16=0000000000000000       r24=00000000802037B4
		 r1=000000008FD8D630        r9=0000000000000000       r17=0000000000000436       r25=0000000000000002
		 r2=0000000002D96A40       r10=00000000802033F4       r18=0000000000000095       r26=0000000000000436
		 r3=0000000000000000       r11=0000000080182C88       r19=0000000000000000       r27=0000000000000000
		 r4=0000000000000000       r12=00000000006FBE38       r20=00000000802037F0       r28=0000000000000000
		 r5=0000000000000001       r13=000000001000C620       r21=00000000802037B4       r29=0000000000004141
		 r6=0000000000000000       r14=0000000000000000       r22=000000008FD8DB64       r30=0000000002D1A27C
		 r7=00000000802033F4       r15=0000000000000000       r23=0000000080203374       r31=00000000802033F4

		xer=0000000000000000       ctr=0000000003D5D01C        lr=0000000003C9BAF0     fpscr=A2008100

		 cr=84822042               cr0=LT cr1=GT cr2=LT cr3=EQ cr4=EQ cr5=   cr6=GT cr7=EQ

		 pc=0000000003C9BB20           lhz  r0,0x0(r9)
		 */
		var str = '_______________________________________________________________________________________________________________________________________' + unescape("\u4141\u2222\u3333\u4444\u5555\u6666\u7777\u8888\u9999\uAAAA\uBBBB\uCCCC\uDDDD\uEEEE\uF111\uF222\uF333\uF444\uF555\uF666\uF777\uF888\uF999\uFAAA\uFBBB\uFCCC\uFDDD\uFEEE\uE111\uE222\uE333\uE444\uE555\uE666\uE777\uE888\uE999\uEAAA\uEBBB\uECCC\uEDDD\uEEEE\uD111\uD222\uD333\uD444\uD555\uD666\uD777\uD888\uD999\uDAAA\uDBBB\uDCCC\uDDDD\uDEEE\uC111\uC222\uC333\uC444\uC555\uC666\uC777\uC888\uC999\uCAAA\uCBBB\uCCCC\uCDDD\uCEEE\uB111\uB222\uB333\uB444\uB555\uB666\uB777\uB888\uB999\uBAAA\uBBBB\uBCCC\uBDDD\uBEEE\uA111\uA222\uA333\uA444\uA555\uA666\uA777\uA888\uA999\uAAAA\uABBB\uACCC\uADDD\uAEEE\u9111\u9222\u9333\u9444\u9555\u9666\u9777\u9888\u9999\u9AAA\u9BBB\u9CCC\u9DDD\u9EEE\u8111\u8222\u8333\u8444\u8555\u8666\u8777\u8888\u8999\u8AAA\u8BBB\u8CCC\u8DDD\u8EEE\u7111\u7222\u7333\u7444\u7555\u7666\u7777\u7888\u7999\u7AAA\u7BBB\u7CCC\u7DDD\u7EEE\u6111\u6222\u6333\u6444\u6555\u6666\u6777\u6888\u6999\u6AAA\u6BBB\u6CCC\u6DDD\u6EEE\u5111\u5222\u5333\u5444\u5555\u5666\u5777\u5888\u5999\u5AAA\u5BBB\u5CCC\u5DDD\u5EEE\u4111\u4222\u4333\u4444\u4555\u4666\u4777\u4888\u4999\u4AAA\u4BBB\u4CCC\u4DDD\u4EEE\u3111\u3222\u3333\u3444\u3555\u3666\u3777\u3888\u3999\u3AAA\u3BBB\u3CCC\u3DDD\u3EEE\u2111\u2222\u2333\u2444\u2555\u2666\u2777\u2888\u2999\u2AAA\u2BBB\u2CCC\u2DDD\u2EEE\u1111\u1222\u1333\u1444\u1555\u1666\u1777\u1888\u1999\u1AAA\u1BBB\u1CCC\u1DDD\u1EEE");
		var div = document.getElementById('highlighted');
		div.innerHTML = '<div>' + str + '\n</div>'

		// Test crash
		var sel = getSelection();
		sel.setPosition(div.firstChild, 0);

		var range = sel.getRangeAt(0);
		var span = document.createElement('SPAN');
		range.insertNode(span);
    }
  </script>
</head>
<body onload="runTest()">
  This tests that inserting a span into a selection of a div with lots of non-word-broken characters doesn't crash.
  <div id="highlighted"></div>
</body>
</html>
