<html>
<script src="include/jquery.js"></script>
<head>
<script>

function hex32(s)
{
	return ('00000000' + s).substr(-8);
}
function hex16(s)
{
	return ('0000' + s).slice(-4)
}
function hex8(s)
{
	return ('00' + s).substr(-2);
}

// Convert a hex string to a byte array
function hexToBytes(hex) {
    for (var bytes = [], c = 0; c < hex.length; c += 2)
    bytes.push(parseInt(hex.substr(c, 2), 16));
    return bytes;
}

function s2hex(str) 
{
	var str_ret = '';
	for (var i = 0; i < str.length; i++)
	{
		str_ret+=hex16((str.charCodeAt(i)).toString(16));
		<!-- if(str.charCodeAt(i)==0){ -->
			<!-- str_ret+=hex8((str.charCodeAt(i) >>> 4).toString(16)); -->
			<!-- str_ret+=hex8((str.charCodeAt(i) & 0xF).toString(16)); -->
		<!-- } -->
		<!-- else -->
		<!-- { -->
			<!-- str_ret+=(str.charCodeAt(i) >>> 4).toString(16); -->
			<!-- str_ret+=(str.charCodeAt(i) & 0xF).toString(16); -->
		<!-- } -->
	}
	return str_ret;
}


// Convert a byte array to a hex string
function bytesToHex(str) {
	var hex = [];
    for (var  i = 0; i < str.length; i++) {
	hex.push(hex16((str.charCodeAt(i)).toString(16)));
	<!-- if(str.charCodeAt(i)==0){ -->
		<!-- hex.push(hex8((str.charCodeAt(i) >>> 4).toString(16))); -->
		<!-- hex.push(hex8((str.charCodeAt(i) & 0xF).toString(16))); -->
	<!-- } -->
	<!-- else -->
	<!-- { -->
		<!-- hex.push((str.charCodeAt(i) >>> 4).toString(16)); -->
		<!-- hex.push((str.charCodeAt(i) & 0xF).toString(16)); -->
	<!-- } -->
    }
    return hex.join("");
}

function initROP()
{
	try
	{
		var usb_fp_rosdump = unescape("\u4444\u2F64\u6576\u5F75\u7362\u3030\u302F\u726F\u7330\u2E68\u6578\u0000\u7762\u0000\u4141\u4141\u4141\u4141\u4141\u7EFD");// 22 bytes for path to fopen + 4 bytes to store wb string + 4 for file descriptor + 2 ros dump placeholder + 4 for place holders
		document.write("gadget bytesToHex: "+s2hex(usb_fp_rosdump));
	} 
	catch(e) 
	{
		document.write(e);
	}
}
</script>
</head>
<body id="BodyID" onload="initROP();">

		<div id="exploit" />
		<br>
		<div id="log"></div>
	</body>
</html>