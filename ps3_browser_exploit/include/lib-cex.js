/*
   Resolved library functions PS3 CEX
*/


// SCE Allocator Functions
sceAllocatorFcns_v481C = 
{
	malloc : 0x006EB8D8,
	free : 0x006EB908,
	memalign : 0x006EB8F8
}


// SCE FS Functions
sceFSFcns_v481C = 
{
	cellFsRename : 0x006ED0F0,
	cellFsClose : 0x006ECCF8,
	cellFsOpen : 0x006ED100,
	cellFsWrite : 0x006ECCF0,
	cellFsRead : 0x006ECCE8,
	cellFsMkdir : 0x006ED0B8,
	cellFsRmdir : 0x006ED118,
	cellFsChmod : 0x006ED050,
	cellFsUnlink : 0x006ED110
}


// SCE VSH Task Functions
sceVSHTaskFcns_v481C = 
{
	vshtask_notify : 0x006D6320
}


// SCE VSH Functions
sceVSH_v481C =
{
	Heap_Create : 0x006EBC50,
	Heap_Alloc : 0x006EBC40,
	Heap_Destroy : 0x006EBC48,
	Heap_Free : 0x006EBC30,
	vsh_E7C34044 : 0x006EBBD8, //retrieves vsh memory container by "id" 0=game,1=app,2=debug,3=fg, 4=bg  sys_memory_container_t vsh_E7C34044(int id) 
	cellFsUtilMount : 0x006ED3A0
}


// SCE Libc Functions
sceLibcFcns_v481C =
{
    abort : 0x006EBEF8,
	exit : 0x006EBF28,
	strcpy : 0x006EC1D0,
	mkdir : 0x006EC300,
	mbrtowc : 0x006EBFE8,
	sprintf : 0x006EC240,
	strlen : 0x006EC080,
	snprintf : 0x006EC230,
	strcmp : 0x006EC1C8,
	fputs : 0x006EBF80,
	memset : 0x006EC380,
	memmove : 0x006EC008,
	wcslen : 0x006EC120,
	fopen : 0x006EBF70,
	stat : 0x006EC310,
	rename : 0x006EC040,
	rmdir : 0x006EC308,
	memcpy : 0x006EC000,
	strcat : 0x006EC1B8,
	strcasecmp : 0x006EC1F0,
	printf : 0x006EC220,
	memcmp : 0x006EC388,
	strstr : 0x006EC098,
	fread : 0x006EBF88,
	strchr : 0x006EC1C0,
	fclose : 0x006EBF30,
	strncmp : 0x006EC1E0,
	strtok : 0x006EC0A0,
	unlink : 0x006EC328,
	fwrite : 0x006EBFB0,
	fprintf : 0x006EC200,
	strdup : 0x006EC0B8,
	mbstowcs : 0x006EBFF0
}

// Check Firmware Version
version_deps =
{
	v4_81C:
	{
        "SceWebKit":        
        {
            gadgets:
            {			
				/*
				ldmr0 : 0x3bc534,			//  ldm	r0, {r0, r3, r4, r9, fp, ip, pc}
				ldmr1 : 0x453ff0,   		//  ldm     r1, {r0, ip, lr, pc}
				ldmr9 : 0x3aa784,			//  ldm	r9, {r2, r5, r8, ip, lr, pc}
				ldmr8 : 0x3a5838,			//  ldm	r8, {r0, r1, r2, r4, r5, ip, lr, pc} 
				ldmr4 : 0x43c858,	        //  ldm	r4, {r1, r3, ip, lr, pc}
				ldmr1_0 : 0x1b5cac, 		//  ldm	r1, {r0, ip, lr, pc}
				ldmr5 : 0x3a506c,			//  ldm	r5, {r0, r2, r3, r4, r5, ip, lr, pc}
				iloop : 0x9851c | 1,        //  infinite loop
                bxlr : 0x2b3a | 1,          //  bx lr
				str3 : 0x7f4ac | 1,         //  str     r3, [r0, #4]; bx  lr
                movr30 : 0x535278 | 1       //  movs    r3, r0 ; bx lr 
				*/
            },
            functions: {}
        },
		"SceFS":
		{
			functions : sceFSFcns_v481C,
			gadgets : {}
		},
		"SceAllocator":
		{
			functions : sceAllocatorFcns_v481C, 
            gadgets : {}
		},
        "SceVshTask":
        { 
            functions : sceVSHTaskFcns_v481C, 
            gadgets : {}
        },
		"SceVsh":
		{
			functions : sceVSH_v481C,
			gadgets : {}
		},
        "SceLibc":
        {
            functions: sceLibcFcns_v481C,
            gadgets : 
            {
				// scesetjmp : 0x13EE0 | 1,
               // scelongjmp : 0x13F10 | 1
            }
        }
    }
};

